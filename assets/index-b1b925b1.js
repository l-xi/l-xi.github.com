import{aA as ae,b as W,d as R,m as oe,i as ne,a as D,_ as O,h as le,E as ce,w as ie,A as re,ai as de,G as A,W as P,aY as J,D as Y,Y as ue,J as _e,I as pe,X as me,aZ as ve}from"./index-d5d958fb.js";import{U as j,C as X,c as M,b as Z,d as fe}from"./useCached-7f6f5d27.js";import{r as S,w as ye,y as ge,v as y,z as h,k as i,l as u,A as H,F as E,u as t,J as N,D as b,B as he,ax as Ce,T as be,t as $e,m as f,a9 as T,G as w,C as m,ay as ke,P as xe,E as V,H as we,aa as Q,a7 as U,O as L,a3 as z,L as K,ag as Ie}from"./vue-6d3cdc5e.js";import{E as Ee}from"./el-divider-ce41fd1c.js";import{E as Se}from"./index-dc60281a.js";import"./xgplayer-de833af9.js";function q(){if(!arguments.length)return[];var a=arguments[0];return ae(a)?a:[a]}const ee=()=>Math.floor(Math.random()*1e4),G=a=>typeof ne(a),Te=W({accordion:Boolean,modelValue:{type:R([Array,String,Number]),default:()=>oe([])}}),Be={[j]:G,[X]:G},te=Symbol("collapseContextKey"),Ne=(a,o)=>{const s=S(q(a.modelValue)),l=n=>{s.value=n;const c=a.accordion?s.value[0]:s.value;o(j,c),o(X,c)},e=n=>{if(a.accordion)l([s.value[0]===n?"":n]);else{const c=[...s.value],r=c.indexOf(n);r>-1?c.splice(r,1):c.push(n),l(c)}};return ye(()=>a.modelValue,()=>s.value=q(a.modelValue),{deep:!0}),ge(te,{activeNames:s,handleItemClick:e}),{activeNames:s,setActiveNames:l}},Ae=()=>{const a=D("collapse");return{rootKls:y(()=>a.b())}},Fe=h({name:"ElCollapse"}),He=h({...Fe,props:Te,emits:Be,setup(a,{expose:o,emit:s}){const l=a,{activeNames:e,setActiveNames:n}=Ne(l,s),{rootKls:c}=Ae();return o({activeNames:e,setActiveNames:n}),(r,g)=>(i(),u("div",{class:E(t(c))},[H(r.$slots,"default")],2))}});var Le=O(He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const Ke=h({name:"ElCollapseTransition"}),Pe=h({...Ke,setup(a){const o=D("collapse-transition"),s=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},l={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){s(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){s(e)},leaveCancelled(e){s(e)}};return(e,n)=>(i(),N(be,he({name:t(o).b()},Ce(l)),{default:b(()=>[H(e.$slots,"default")]),_:3},16,["name"]))}});var F=O(Pe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);F.install=a=>{a.component(F.name,F)};const Ve=F,De=W({title:{type:String,default:""},name:{type:R([String,Number]),default:()=>ee()},disabled:Boolean}),Oe=a=>{const o=$e(te),s=S(!1),l=S(!1),e=S(ee()),n=y(()=>o==null?void 0:o.activeNames.value.includes(a.name));return{focusing:s,id:e,isActive:n,handleFocus:()=>{setTimeout(()=>{l.value?l.value=!1:s.value=!0},50)},handleHeaderClick:()=>{a.disabled||(o==null||o.handleItemClick(a.name),s.value=!1,l.value=!0)},handleEnterClick:()=>{o==null||o.handleItemClick(a.name)}}},Me=(a,{focusing:o,isActive:s,id:l})=>{const e=D("collapse"),n=y(()=>[e.b("item"),e.is("active",t(s)),e.is("disabled",a.disabled)]),c=y(()=>[e.be("item","header"),e.is("active",t(s)),{focusing:t(o)&&!a.disabled}]),r=y(()=>[e.be("item","arrow"),e.is("active",t(s))]),g=y(()=>e.be("item","wrap")),C=y(()=>e.be("item","content")),d=y(()=>e.b(`content-${t(l)}`)),_=y(()=>e.b(`head-${t(l)}`));return{arrowKls:r,headKls:c,rootKls:n,itemWrapperKls:g,itemContentKls:C,scopedContentId:d,scopedHeadId:_}},Ue=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],ze=["id","aria-hidden","aria-labelledby"],qe=h({name:"ElCollapseItem"}),Ge=h({...qe,props:De,setup(a,{expose:o}){const s=a,{focusing:l,id:e,isActive:n,handleFocus:c,handleHeaderClick:r,handleEnterClick:g}=Oe(s),{arrowKls:C,headKls:d,rootKls:_,itemWrapperKls:B,itemContentKls:I,scopedContentId:$,scopedHeadId:k}=Me(s,{focusing:l,isActive:n,id:e});return o({isActive:n}),(v,p)=>(i(),u("div",{class:E(t(_))},[f("button",{id:t(k),class:E(t(d)),"aria-expanded":t(n),"aria-controls":t($),"aria-describedby":t($),tabindex:v.disabled?-1:0,onClick:p[0]||(p[0]=(...x)=>t(r)&&t(r)(...x)),onKeydown:p[1]||(p[1]=ke(xe((...x)=>t(g)&&t(g)(...x),["stop","prevent"]),["space","enter"])),onFocus:p[2]||(p[2]=(...x)=>t(c)&&t(c)(...x)),onBlur:p[3]||(p[3]=x=>l.value=!1)},[H(v.$slots,"title",{},()=>[T(w(v.title),1)]),m(t(ce),{class:E(t(C))},{default:b(()=>[m(t(le))]),_:1},8,["class"])],42,Ue),m(t(Ve),null,{default:b(()=>[V(f("div",{id:t($),role:"region",class:E(t(B)),"aria-hidden":!t(n),"aria-labelledby":t(k)},[f("div",{class:E(t(I))},[H(v.$slots,"default")],2)],10,ze),[[we,t(n)]])]),_:3})],2))}});var se=O(Ge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const We=ie(Le,{CollapseItem:se}),Re=re(se);const Je={class:"item-info contact-item"},Ye={class:"item-info-right"},je={class:"item-info-name"},Xe=h({__name:"ContactItem",props:{item:{}},setup(a){const o=a,{item:s}=Q(o),l=y(()=>{var n;return(n=s==null?void 0:s.value)==null?void 0:n.uid}),e=M(l.value);return(n,c)=>{const r=U("Avatar");return i(),u("div",Je,[m(r,{class:"avatar",src:t(e).avatar,size:40,showStatus:"",online:t(s).activeStatus===t(de).ONLINE},null,8,["src","online"]),f("div",Ye,[f("span",je,w(t(e).name),1)])])}}});const Ze=A(Xe,[["__scopeId","data-v-500cee00"]]),Qe={class:"item-info"},et={class:"item-info-right"},tt={class:"item-info-name"},st={key:1,class:"item-info-accept-text"},at={class:"item-info-msg"},ot=h({__name:"NewFriendItem",props:{item:{}},setup(a){const o=a,{item:s}=Q(o),l=P(),e=y(()=>{var c;return(c=s==null?void 0:s.value)==null?void 0:c.uid}),n=M(e.value);return(c,r)=>{var C;const g=U("Avatar");return i(),u("div",Qe,[m(g,{class:"avatar",src:t(n).avatar,size:40},null,8,["src"]),f("div",et,[f("span",tt,[T(w(t(n).name)+" ",1),t(s).status===t(J).Waiting?(i(),u("button",{key:0,class:"item-info-accept-btn",onClick:r[0]||(r[0]=d=>t(l).onAcceptFriend(t(s).applyId))}," 接受 ")):(i(),u("span",st,"已添加"))]),f("span",at,w((C=t(s))==null?void 0:C.msg),1)])])}}});const nt=A(ot,[["__scopeId","data-v-f4b27781"]]),lt={class:"side"},ct=["infinite-scroll-disabled"],it={key:0,class:"read-unread-no-data"},rt=["infinite-scroll-disabled"],dt={key:0,class:"read-unread-no-data"},ut=h({__name:"index",setup(a){const o=P(),s=Y(),l=S("1"),e=S(!0),n=d=>{s.currentSelectedContact=d},c=()=>{o.getRequestFriendsList()},r=()=>{o.getContactList()},g=()=>{e.value=!0,setTimeout(()=>{e.value=!1},500)},C=()=>{s.createGroupModalInfo.show=!0};return(d,_)=>{const B=Z,I=Re,$=We,k=fe;return i(),u("div",lt,[m(B,{class:"add-group",type:"primary",size:"small",onClick:C},{default:b(()=>[T("创建群聊")]),_:1}),m($,{class:"side-collapse",modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=v=>l.value=v),onChange:g,accordion:""},{default:b(()=>[m(I,{title:"新的朋友",name:"1"},{default:b(()=>{var v;return[V((i(),u("ul",{"infinite-scroll-disabled":e.value,class:"read-unread-list"},[(i(!0),u(L,null,z(t(o).requestFriendsList,p=>(i(),N(nt,{key:p.uid,item:p,onClick:x=>n(p)},null,8,["item","onClick"]))),128)),((v=t(o).requestFriendsList)==null?void 0:v.length)===0?(i(),u("li",it," 暂无数据~ ")):K("",!0)],8,ct)),[[k,c]])]}),_:1}),m(I,{title:"联系人",name:"2"},{default:b(()=>{var v;return[V((i(),u("ul",{"infinite-scroll-disabled":e.value,class:"read-unread-list"},[(i(!0),u(L,null,z(t(o).contactsList,p=>(i(),N(Ze,{key:p.uid,item:p,onClick:x=>n(p)},null,8,["item","onClick"]))),128)),((v=t(o).contactsList)==null?void 0:v.length)===0?(i(),u("li",dt," 暂无数据~ ")):K("",!0)],8,rt)),[[k,r]])]}),_:1})]),_:1},8,["modelValue"])])}}});const _t=A(ut,[["__scopeId","data-v-f2acf1e2"]]),pt={class:"contact-content"},mt={key:0,class:"contact-main"},vt={class:"contact-info-wrapper"},ft={class:"contact-info"},yt={class:"contact-info-name"},gt={class:"contact-info-uid"},ht={class:"contact-info-place"},Ct={class:"contact-request-msg"},bt={class:"contact-info-buttons"},$t=h({__name:"index",setup(a){const o=P(),s=ue(),l=Y(),e=y(()=>l.currentSelectedContact),n=y(()=>{var d;return(d=e==null?void 0:e.value)==null?void 0:d.uid}),c=y(()=>{var d;return((d=e.value)==null?void 0:d.status)===J.Waiting}),r=M(n),g=d=>{Se.confirm("确认删除该联系人?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await o.onDeleteContact(d),_e.success("删除成功!")}).catch(()=>{})},C=async d=>{const _=await pe.sessionDetailWithFriends({uid:d}).send();l.currentSession.roomId=_.roomId,l.currentSession.type=me.Single,s.updateSessionLastActiveTime(_.roomId,_),ve.push("/")};return(d,_)=>{var k;const B=U("Avatar"),I=Ee,$=Z;return i(),u("div",pt,[n.value?(i(),u("div",mt,[f("div",vt,[m(B,{class:"avatar",src:t(r).avatar,size:70},null,8,["src"]),f("div",ft,[f("span",yt,w(t(r).name),1),f("span",gt," uid: "+w(t(r).uid),1),f("span",ht," 地区: "+w(t(r).locPlace||"-"),1)])]),m(I),c.value&&((k=e.value)!=null&&k.msg)?(i(),u(L,{key:0},[f("div",Ct," Ta说: "+w(e.value.msg),1),m(I)],64)):K("",!0),f("div",bt,[c.value?(i(),N($,{key:0,type:"success",onClick:_[0]||(_[0]=v=>t(o).onAcceptFriend(e.value.applyId))},{default:b(()=>[T("接受")]),_:1})):(i(),u(L,{key:1},[m($,{type:"primary",onClick:_[1]||(_[1]=v=>C(e.value.uid))},{default:b(()=>[T("发消息")]),_:1}),m($,{type:"danger",onClick:_[2]||(_[2]=v=>g(e.value.uid))},{default:b(()=>[T(" 删除联系人 ")]),_:1})],64))])])):K("",!0)])}}});const kt=A($t,[["__scopeId","data-v-ddd15e56"]]),xt={class:"contact-page"},wt=h({__name:"index",setup(a){return(o,s)=>(i(),u("div",xt,[m(_t),m(kt)]))}});const It=A(wt,[["__scopeId","data-v-e7a64e39"]]),Ft=h({__name:"index",setup(a){const o=P();return Ie(()=>{o.getContactList(!0),o.getRequestFriendsList(!0)}),(s,l)=>(i(),N(It))}});export{Ft as default};
