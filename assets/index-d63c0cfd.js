var nr=Object.defineProperty;var or=(a,r,u)=>r in a?nr(a,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):a[r]=u;var Sn=(a,r,u)=>(or(a,typeof r!="symbol"?r+"":r,u),u);import{b as xt,a1 as rr,i as so,a2 as Tn,d as ht,a as Jt,a3 as Qt,E as yt,_ as Lt,w as en,e as sr,u as ao,a4 as ar,a5 as ir,a6 as lr,a7 as ur,a8 as Yt,a9 as cr,aa as jt,ab as Kn,ac as se,Y as bt,D as it,ad as dr,ae as io,F as Ln,G as lt,B as _t,C as Ft,af as Et,ag as lo,ah as rt,I as at,ai as fr,aj as $n,v as pr,ak as mr,al as vr,U as gr,am as Rn,an as gt,ao as It,ap as qn,aq as Bn,J as st,X as uo,ar as Xn,as as hr}from"./index-d5d958fb.js";import{e as yr,g as br,u as Yn,h as Zn,b as Ot,c as tn,d as _r,i as Cr}from"./useCached-7f6f5d27.js";import{d as kr,c as Sr,u as xr,e as Mn,f as Je,E as nn,M as At,b as wr,a as co,j as Ir}from"./message-c547b052.js";import{z as me,r as A,v as q,h as Nn,w as ot,k as E,l as j,K as zt,u as x,J as ie,D as B,M as fo,A as ct,F as ve,a7 as De,C as O,E as be,m as L,B as Ut,P as St,G as de,L as Q,H as He,T as kt,a4 as Mr,y as Dt,t as Zt,e as mt,ae as po,a9 as Ne,X as on,$ as Er,aa as mo,ad as Pt,n as $t,f as vo,x as Or,af as Tr,ag as go,O as ft,a3 as Tt,ah as Lr,ai as ho,a8 as pt,o as jn,aj as $r,a5 as Rr,ak as Br,al as Mt,ab as rn,ac as sn,am as Nr,an as jr,a as yo,ao as Ar,ap as Pr}from"./vue-6d3cdc5e.js";import{a as zr,c as Dr,g as Fr}from"./xgplayer-de833af9.js";import{E as Ur}from"./el-divider-ce41fd1c.js";const Vr=xt({size:{type:[Number,String],values:rr,default:"",validator:a=>so(a)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Tn},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:ht(String),default:"cover"}}),Hr={error:a=>a instanceof Event},Wr=["src","alt","srcset"],Gr=me({name:"ElAvatar"}),Kr=me({...Gr,props:Vr,emits:Hr,setup(a,{emit:r}){const u=a,p=Jt("avatar"),g=A(!1),h=q(()=>{const{size:e,icon:n,shape:s}=u,t=[p.b()];return Nn(e)&&t.push(p.m(e)),n&&t.push(p.m("icon")),s&&t.push(p.m(s)),t}),b=q(()=>{const{size:e}=u;return so(e)?p.cssVarBlock({size:Qt(e)||""}):void 0}),o=q(()=>({objectFit:u.fit}));ot(()=>u.src,()=>g.value=!1);function l(e){g.value=!0,r("error",e)}return(e,n)=>(E(),j("span",{class:ve(x(h)),style:zt(x(b))},[(e.src||e.srcSet)&&!g.value?(E(),j("img",{key:0,src:e.src,alt:e.alt,srcset:e.srcSet,style:zt(x(o)),onError:l},null,44,Wr)):e.icon?(E(),ie(x(yt),{key:1},{default:B(()=>[(E(),ie(fo(e.icon)))]),_:1})):ct(e.$slots,"default",{key:2})],6))}});var qr=Lt(Kr,[["__file","/home/runner/work/element-plus/element-plus/packages/components/avatar/src/avatar.vue"]]);const An=en(qr),Xr=xt({...kr,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),Yr=Sr,Zr=me({name:"ElDrawer",components:{ElOverlay:yr,ElFocusTrap:br,ElIcon:yt,Close:sr},inheritAttrs:!1,props:Xr,emits:Yr,setup(a,{slots:r}){Yn({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},q(()=>!!r.title)),Yn({scope:"el-drawer",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/drawer.html#attributes",type:"Attribute"},q(()=>!!a.customClass));const u=A(),p=A(),g=Jt("drawer"),{t:h}=ao(),b=q(()=>a.direction==="rtl"||a.direction==="ltr"),o=q(()=>Qt(a.size));return{...xr(a,u),drawerRef:u,focusStartRef:p,isHorizontal:b,drawerSize:o,ns:g,t:h}}}),Jr=["aria-label","aria-labelledby","aria-describedby"],Qr=["id","aria-level"],es=["aria-label"],ts=["id"];function ns(a,r,u,p,g,h){const b=De("close"),o=De("el-icon"),l=De("el-focus-trap"),e=De("el-overlay");return E(),ie(Mr,{to:"body",disabled:!a.appendToBody},[O(kt,{name:a.ns.b("fade"),onAfterEnter:a.afterEnter,onAfterLeave:a.afterLeave,onBeforeLeave:a.beforeLeave,persisted:""},{default:B(()=>[be(O(e,{mask:a.modal,"overlay-class":a.modalClass,"z-index":a.zIndex,onClick:a.onModalClick},{default:B(()=>[O(l,{loop:"",trapped:a.visible,"focus-trap-el":a.drawerRef,"focus-start-el":a.focusStartRef,onReleaseRequested:a.onCloseRequested},{default:B(()=>[L("div",Ut({ref:"drawerRef","aria-modal":"true","aria-label":a.title||void 0,"aria-labelledby":a.title?void 0:a.titleId,"aria-describedby":a.bodyId},a.$attrs,{class:[a.ns.b(),a.direction,a.visible&&"open",a.customClass],style:a.isHorizontal?"width: "+a.drawerSize:"height: "+a.drawerSize,role:"dialog",onClick:r[1]||(r[1]=St(()=>{},["stop"]))}),[L("span",{ref:"focusStartRef",class:ve(a.ns.e("sr-focus")),tabindex:"-1"},null,2),a.withHeader?(E(),j("header",{key:0,class:ve(a.ns.e("header"))},[a.$slots.title?ct(a.$slots,"title",{key:1},()=>[Q(" DEPRECATED SLOT ")]):ct(a.$slots,"header",{key:0,close:a.handleClose,titleId:a.titleId,titleClass:a.ns.e("title")},()=>[a.$slots.title?Q("v-if",!0):(E(),j("span",{key:0,id:a.titleId,role:"heading","aria-level":a.headerAriaLevel,class:ve(a.ns.e("title"))},de(a.title),11,Qr))]),a.showClose?(E(),j("button",{key:2,"aria-label":a.t("el.drawer.close"),class:ve(a.ns.e("close-btn")),type:"button",onClick:r[0]||(r[0]=(...n)=>a.handleClose&&a.handleClose(...n))},[O(o,{class:ve(a.ns.e("close"))},{default:B(()=>[O(b)]),_:1},8,["class"])],10,es)):Q("v-if",!0)],2)):Q("v-if",!0),a.rendered?(E(),j("div",{key:1,id:a.bodyId,class:ve(a.ns.e("body"))},[ct(a.$slots,"default")],10,ts)):Q("v-if",!0),a.$slots.footer?(E(),j("div",{key:2,class:ve(a.ns.e("footer"))},[ct(a.$slots,"footer")],2)):Q("v-if",!0)],16,Jr)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[He,a.visible]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"])}var os=Lt(Zr,[["render",ns],["__file","/home/runner/work/element-plus/element-plus/packages/components/drawer/src/drawer.vue"]]);const rs=en(os),ss=me({inheritAttrs:!1});function as(a,r,u,p,g,h){return ct(a.$slots,"default")}var is=Lt(ss,[["render",as],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const ls=me({name:"ElCollectionItem",inheritAttrs:!1});function us(a,r,u,p,g,h){return ct(a.$slots,"default")}var cs=Lt(ls,[["render",us],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const ds="data-el-collection-item",fs=a=>{const r=`El${a}Collection`,u=`${r}Item`,p=Symbol(r),g=Symbol(u),h={...is,name:r,setup(){const o=A(null),l=new Map;Dt(p,{itemMap:l,getItems:()=>{const n=x(o);if(!n)return[];const s=Array.from(n.querySelectorAll(`[${ds}]`));return[...l.values()].sort((i,d)=>s.indexOf(i.ref)-s.indexOf(d.ref))},collectionRef:o})}},b={...cs,name:u,setup(o,{attrs:l}){const e=A(null),n=Zt(p,void 0);Dt(g,{collectionItemRef:e}),mt(()=>{const s=x(e);s&&n.itemMap.set(s,{ref:s,...l})}),po(()=>{const s=x(e);n.itemMap.delete(s)})}};return{COLLECTION_INJECTION_KEY:p,COLLECTION_ITEM_INJECTION_KEY:g,ElCollection:h,ElCollectionItem:b}},xn=xt({trigger:Mn.trigger,effect:{...Je.effect,default:"light"},type:{type:ht(String)},placement:{type:ht(String),default:"bottom"},popperOptions:{type:ht(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:ht([Number,String]),default:0},maxHeight:{type:ht([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:ht(Object)},teleported:Je.teleported});xt({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Tn}});xt({onKeydown:{type:ht(Function)}});fs("Dropdown");const ps=xt({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:Zn,default:"primary"},cancelButtonType:{type:String,values:Zn,default:"text"},icon:{type:Tn,default:()=>ar},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Je.teleported,persistent:Je.persistent,width:{type:[String,Number],default:150}}),ms={confirm:a=>a instanceof MouseEvent,cancel:a=>a instanceof MouseEvent},vs=me({name:"ElPopconfirm"}),gs=me({...vs,props:ps,emits:ms,setup(a,{emit:r}){const u=a,{t:p}=ao(),g=Jt("popconfirm"),h=A(),b=()=>{var t,i;(i=(t=h.value)==null?void 0:t.onClose)==null||i.call(t)},o=q(()=>({width:Qt(u.width)})),l=t=>{r("confirm",t),b()},e=t=>{r("cancel",t),b()},n=q(()=>u.confirmButtonText||p("el.popconfirm.confirmButtonText")),s=q(()=>u.cancelButtonText||p("el.popconfirm.cancelButtonText"));return(t,i)=>(E(),ie(x(nn),Ut({ref_key:"tooltipRef",ref:h,trigger:"click",effect:"light"},t.$attrs,{"popper-class":`${x(g).namespace.value}-popover`,"popper-style":x(o),teleported:t.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":t.hideAfter,persistent:t.persistent}),{content:B(()=>[L("div",{class:ve(x(g).b())},[L("div",{class:ve(x(g).e("main"))},[!t.hideIcon&&t.icon?(E(),ie(x(yt),{key:0,class:ve(x(g).e("icon")),style:zt({color:t.iconColor})},{default:B(()=>[(E(),ie(fo(t.icon)))]),_:1},8,["class","style"])):Q("v-if",!0),Ne(" "+de(t.title),1)],2),L("div",{class:ve(x(g).e("action"))},[O(x(Ot),{size:"small",type:t.cancelButtonType==="text"?"":t.cancelButtonType,text:t.cancelButtonType==="text",onClick:e},{default:B(()=>[Ne(de(x(s)),1)]),_:1},8,["type","text"]),O(x(Ot),{size:"small",type:t.confirmButtonType==="text"?"":t.confirmButtonType,text:t.confirmButtonType==="text",onClick:l},{default:B(()=>[Ne(de(x(n)),1)]),_:1},8,["type","text"])],2)],2)]),default:B(()=>[t.$slots.reference?ct(t.$slots,"reference",{key:0}):Q("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var hs=Lt(gs,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]]);const bo=en(hs),ys=xt({trigger:Mn.trigger,placement:xn.placement,disabled:Mn.disabled,visible:Je.visible,transition:Je.transition,popperOptions:xn.popperOptions,tabindex:xn.tabindex,content:Je.content,popperStyle:Je.popperStyle,popperClass:Je.popperClass,enterable:{...Je.enterable,default:!0},effect:{...Je.effect,default:"light"},teleported:Je.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),bs={"update:visible":a=>ir(a),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},_s="onUpdate:visible",Cs=me({name:"ElPopover"}),ks=me({...Cs,props:ys,emits:bs,setup(a,{expose:r,emit:u}){const p=a,g=q(()=>p[_s]),h=Jt("popover"),b=A(),o=q(()=>{var f;return(f=x(b))==null?void 0:f.popperRef}),l=q(()=>[{width:Qt(p.width)},p.popperStyle]),e=q(()=>[h.b(),p.popperClass,{[h.m("plain")]:!!p.content}]),n=q(()=>p.transition===`${h.namespace.value}-fade-in-linear`),s=()=>{var f;(f=b.value)==null||f.hide()},t=()=>{u("before-enter")},i=()=>{u("before-leave")},d=()=>{u("after-enter")},c=()=>{u("update:visible",!1),u("after-leave")};return r({popperRef:o,hide:s}),(f,v)=>(E(),ie(x(nn),Ut({ref_key:"tooltipRef",ref:b},f.$attrs,{trigger:f.trigger,placement:f.placement,disabled:f.disabled,visible:f.visible,transition:f.transition,"popper-options":f.popperOptions,tabindex:f.tabindex,content:f.content,offset:f.offset,"show-after":f.showAfter,"hide-after":f.hideAfter,"auto-close":f.autoClose,"show-arrow":f.showArrow,"aria-label":f.title,effect:f.effect,enterable:f.enterable,"popper-class":x(e),"popper-style":x(l),teleported:f.teleported,persistent:f.persistent,"gpu-acceleration":x(n),"onUpdate:visible":x(g),onBeforeShow:t,onBeforeHide:i,onShow:d,onHide:c}),{content:B(()=>[f.title?(E(),j("div",{key:0,class:ve(x(h).e("title")),role:"title"},de(f.title),3)):Q("v-if",!0),ct(f.$slots,"default",{},()=>[Ne(de(f.content),1)])]),default:B(()=>[f.$slots.reference?ct(f.$slots,"reference",{key:0}):Q("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Ss=Lt(ks,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popover/src/popover.vue"]]);const Jn=(a,r)=>{const u=r.arg||r.value,p=u==null?void 0:u.popperRef;p&&(p.triggerRef=a)};var xs={mounted(a,r){Jn(a,r)},updated(a,r){Jn(a,r)}};const ws="popover",Is=lr(xs,ws),_o=en(Ss,{directive:Is});function Ms(a){let r;const u=A(!1),p=on({...a,originalPosition:"",originalOverflow:"",visible:!1});function g(t){p.text=t}function h(){const t=p.parent,i=s.ns;if(!t.vLoadingAddClassList){let d=t.getAttribute("loading-number");d=Number.parseInt(d)-1,d?t.setAttribute("loading-number",d.toString()):(Yt(t,i.bm("parent","relative")),t.removeAttribute("loading-number")),Yt(t,i.bm("parent","hidden"))}b(),n.unmount()}function b(){var t,i;(i=(t=s.$el)==null?void 0:t.parentNode)==null||i.removeChild(s.$el)}function o(){var t;a.beforeClose&&!a.beforeClose()||(u.value=!0,clearTimeout(r),r=window.setTimeout(l,400),p.visible=!1,(t=a.closed)==null||t.call(a))}function l(){if(!u.value)return;const t=p.parent;u.value=!1,t.vLoadingAddClassList=void 0,h()}const e=me({name:"ElLoading",setup(t,{expose:i}){const{ns:d,zIndex:c}=ur("loading");return i({ns:d,zIndex:c}),()=>{const f=p.spinner||p.svg,v=Pt("svg",{class:"circular",viewBox:p.svgViewBox?p.svgViewBox:"0 0 50 50",...f?{innerHTML:f}:{}},[Pt("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),y=p.text?Pt("p",{class:d.b("text")},[p.text]):void 0;return Pt(kt,{name:d.b("fade"),onAfterLeave:l},{default:B(()=>[be(O("div",{style:{backgroundColor:p.background||""},class:[d.b("mask"),p.customClass,p.fullscreen?"is-fullscreen":""]},[Pt("div",{class:d.b("spinner")},[v,y])]),[[He,p.visible]])])})}}}),n=Er(e),s=n.mount(document.createElement("div"));return{...mo(p),setText:g,removeElLoadingChild:b,close:o,handleAfterLeave:l,vm:s,get $el(){return s.$el}}}let qt;const Es=function(a={}){if(!cr)return;const r=Os(a);if(r.fullscreen&&qt)return qt;const u=Ms({...r,closed:()=>{var g;(g=r.closed)==null||g.call(r),r.fullscreen&&(qt=void 0)}});Ts(r,r.parent,u),Qn(r,r.parent,u),r.parent.vLoadingAddClassList=()=>Qn(r,r.parent,u);let p=r.parent.getAttribute("loading-number");return p?p=`${Number.parseInt(p)+1}`:p="1",r.parent.setAttribute("loading-number",p),r.parent.appendChild(u.$el),$t(()=>u.visible.value=r.visible),r.fullscreen&&(qt=u),u},Os=a=>{var r,u,p,g;let h;return Nn(a.target)?h=(r=document.querySelector(a.target))!=null?r:document.body:h=a.target||document.body,{parent:h===document.body||a.body?document.body:h,background:a.background||"",svg:a.svg||"",svgViewBox:a.svgViewBox||"",spinner:a.spinner||!1,text:a.text||"",fullscreen:h===document.body&&((u=a.fullscreen)!=null?u:!0),lock:(p=a.lock)!=null?p:!1,customClass:a.customClass||"",visible:(g=a.visible)!=null?g:!0,target:h}},Ts=async(a,r,u)=>{const{nextZIndex:p}=u.vm.zIndex||u.vm._.exposed.zIndex,g={};if(a.fullscreen)u.originalPosition.value=jt(document.body,"position"),u.originalOverflow.value=jt(document.body,"overflow"),g.zIndex=p();else if(a.parent===document.body){u.originalPosition.value=jt(document.body,"position"),await $t();for(const h of["top","left"]){const b=h==="top"?"scrollTop":"scrollLeft";g[h]=`${a.target.getBoundingClientRect()[h]+document.body[b]+document.documentElement[b]-Number.parseInt(jt(document.body,`margin-${h}`),10)}px`}for(const h of["height","width"])g[h]=`${a.target.getBoundingClientRect()[h]}px`}else u.originalPosition.value=jt(r,"position");for(const[h,b]of Object.entries(g))u.$el.style[h]=b},Qn=(a,r,u)=>{const p=u.vm.ns||u.vm._.exposed.ns;["absolute","fixed","sticky"].includes(u.originalPosition.value)?Yt(r,p.bm("parent","relative")):Kn(r,p.bm("parent","relative")),a.fullscreen&&a.lock?Kn(r,p.bm("parent","hidden")):Yt(r,p.bm("parent","hidden"))},En=Symbol("ElLoading"),eo=(a,r)=>{var u,p,g,h;const b=r.instance,o=t=>vo(r.value)?r.value[t]:void 0,l=t=>{const i=Nn(t)&&(b==null?void 0:b[t])||t;return i&&A(i)},e=t=>l(o(t)||a.getAttribute(`element-loading-${Tr(t)}`)),n=(u=o("fullscreen"))!=null?u:r.modifiers.fullscreen,s={text:e("text"),svg:e("svg"),svgViewBox:e("svgViewBox"),spinner:e("spinner"),background:e("background"),customClass:e("customClass"),fullscreen:n,target:(p=o("target"))!=null?p:n?void 0:a,body:(g=o("body"))!=null?g:r.modifiers.body,lock:(h=o("lock"))!=null?h:r.modifiers.lock};a[En]={options:s,instance:Es(s)}},Ls=(a,r)=>{for(const u of Object.keys(r))Or(r[u])&&(r[u].value=a[u])},$s={mounted(a,r){r.value&&eo(a,r)},updated(a,r){const u=a[En];r.oldValue!==r.value&&(r.value&&!r.oldValue?eo(a,r):r.value&&r.oldValue?vo(r.value)&&Ls(r.value,u.options):u==null||u.instance.close())},unmounted(a){var r;(r=a[En])==null||r.instance.close()}};const Co=(a,r,u)=>{switch(r){case se.SYSTEM:case se.TEXT:return`${a}:${u}`;case se.IMAGE:return`${a}: ${At[se.IMAGE]}`;case se.FILE:return`${a}: ${At[se.FILE]}`;case se.VOICE:return`${a}: ${At[se.VOICE]}`;case se.VIDEO:return`${a}: ${At[se.VIDEO]}`;case se.EMOJI:return`${a}: ${At[se.EMOJI]}`;default:return""}},Rs={class:"chat-message","infinite-scroll-immediate":!1},Bs=["data-room-id","onClick"],Ns={class:"item-wrapper"},js={class:"message-info"},As={style:{"white-space":"nowrap"}},Ps={class:"person"},zs={key:0,class:"tag"},Ds={class:"message-message"},Fs={class:"message-time"},Us=me({__name:"index",setup(a){const r=bt(),u=it();go(()=>{r.getSessionList()});const p=q(()=>u.currentSession),g=q(()=>r.sessionList.map(o=>{var n,s,t,i,d,c,f,v;const l=(t=(s=Array.from(((n=r.messageMap.get(o.roomId))==null?void 0:n.values())||[]))==null?void 0:s.slice(-1))==null?void 0:t[0];let e="";if(l){const y=tn(l.fromUser.uid);e=((i=l.message)==null?void 0:i.type)===se.RECALL?`${y.value.name}:'撤回了一条消息'`:Co(y.value.name,(d=l.message)==null?void 0:d.type,((f=(c=l.message)==null?void 0:c.body)==null?void 0:f.content)||((v=l.message)==null?void 0:v.body))}return{...o,tag:o.hot_Flag===dr.Yes?"官方":"",lastMsg:e||o.text||"欢迎使用MallChat",lastMsgTime:io(o==null?void 0:o.activeTime)}})),h=(o,l)=>{u.currentSession.roomId=o,u.currentSession.type=l},b=()=>{r.getSessionList()};return(o,l)=>{const e=An,n=Ln,s=_r;return be((E(),j("ul",Rs,[(E(!0),j(ft,null,Tt(g.value,(t,i)=>(E(),j("li",{key:i,"data-room-id":t.roomId,class:ve(["chat-message-item",{active:p.value.roomId===t.roomId}]),onClick:d=>h(t.roomId,t.type)},[L("div",Ns,[O(n,{value:t.unreadCount,max:999,hidden:t.unreadCount<1,class:"item"},{default:B(()=>[O(e,{shape:"circle",size:38,src:t.avatar},null,8,["src"])]),_:2},1032,["value","hidden"]),L("div",js,[L("div",As,[L("span",Ps,de(t.name),1),t.tag?(E(),j("span",zs,de(t.tag),1)):Q("",!0)]),L("div",Ds,de(t.lastMsg),1)]),L("span",Fs,de(t.lastMsgTime),1)])],10,Bs))),128))])),[[s,b]])}}});const Vs=lt(Us,[["__scopeId","data-v-24c2dd05"]]);const Hs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ws=L("path",{fill:"currentColor",d:"m174.72 855.68l135.296-45.12l23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160S128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8l-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512C64 299.904 256 96 512 96s448 203.904 448 416s-192 416-448 416a461.056 461.056 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),Gs=L("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4zm192 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4zm-384 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4z"},null,-1),Ks=[Ws,Gs];function qs(a,r){return E(),j("svg",Hs,Ks)}const Xs={name:"ep-chat-dot-round",render:qs};var ko={exports:{}};const Ys=zr(Lr);(function(a,r){(function(u,p){a.exports=p(Ys)})(typeof self<"u"?self:Dr,u=>(()=>{var p={9662:(o,l,e)=>{var n=e(614),s=e(6330),t=TypeError;o.exports=function(i){if(n(i))return i;throw t(s(i)+" is not a function")}},6077:(o,l,e)=>{var n=e(614),s=String,t=TypeError;o.exports=function(i){if(typeof i=="object"||n(i))return i;throw t("Can't set "+s(i)+" as a prototype")}},1223:(o,l,e)=>{var n=e(5112),s=e(30),t=e(3070).f,i=n("unscopables"),d=Array.prototype;d[i]==null&&t(d,i,{configurable:!0,value:s(null)}),o.exports=function(c){d[i][c]=!0}},9670:(o,l,e)=>{var n=e(111),s=String,t=TypeError;o.exports=function(i){if(n(i))return i;throw t(s(i)+" is not an object")}},8533:(o,l,e)=>{var n=e(2092).forEach,s=e(9341),t=s("forEach");o.exports=t?[].forEach:function(i){return n(this,i,arguments.length>1?arguments[1]:void 0)}},1318:(o,l,e)=>{var n=e(5656),s=e(1400),t=e(6244),i=function(d){return function(c,f,v){var y,C=n(c),k=t(C),I=s(v,k);if(d&&f!=f){for(;k>I;)if(y=C[I++],y!=y)return!0}else for(;k>I;I++)if((d||I in C)&&C[I]===f)return d||I||0;return!d&&-1}};o.exports={includes:i(!0),indexOf:i(!1)}},2092:(o,l,e)=>{var n=e(9974),s=e(1702),t=e(8361),i=e(7908),d=e(6244),c=e(5417),f=s([].push),v=function(y){var C=y==1,k=y==2,I=y==3,_=y==4,M=y==6,$=y==7,z=y==5||M;return function(X,U,J,H){for(var ee,le,T=i(X),D=t(T),oe=n(U,J),_e=d(D),S=0,P=H||c,Y=C?P(X,_e):k||$?P(X,0):void 0;_e>S;S++)if((z||S in D)&&(ee=D[S],le=oe(ee,S,T),y))if(C)Y[S]=le;else if(le)switch(y){case 3:return!0;case 5:return ee;case 6:return S;case 2:f(Y,ee)}else switch(y){case 4:return!1;case 7:f(Y,ee)}return M?-1:I||_?_:Y}};o.exports={forEach:v(0),map:v(1),filter:v(2),some:v(3),every:v(4),find:v(5),findIndex:v(6),filterReject:v(7)}},1194:(o,l,e)=>{var n=e(7293),s=e(5112),t=e(7392),i=s("species");o.exports=function(d){return t>=51||!n(function(){var c=[],f=c.constructor={};return f[i]=function(){return{foo:1}},c[d](Boolean).foo!==1})}},9341:(o,l,e)=>{var n=e(7293);o.exports=function(s,t){var i=[][s];return!!i&&n(function(){i.call(null,t||function(){return 1},1)})}},3658:(o,l,e)=>{var n=e(9781),s=e(3157),t=TypeError,i=Object.getOwnPropertyDescriptor,d=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(c){return c instanceof TypeError}}();o.exports=d?function(c,f){if(s(c)&&!i(c,"length").writable)throw t("Cannot set read only .length");return c.length=f}:function(c,f){return c.length=f}},206:(o,l,e)=>{var n=e(1702);o.exports=n([].slice)},7475:(o,l,e)=>{var n=e(3157),s=e(4411),t=e(111),i=e(5112),d=i("species"),c=Array;o.exports=function(f){var v;return n(f)&&(v=f.constructor,s(v)&&(v===c||n(v.prototype))?v=void 0:t(v)&&(v=v[d],v===null&&(v=void 0))),v===void 0?c:v}},5417:(o,l,e)=>{var n=e(7475);o.exports=function(s,t){return new(n(s))(t===0?0:t)}},4326:(o,l,e)=>{var n=e(1702),s=n({}.toString),t=n("".slice);o.exports=function(i){return t(s(i),8,-1)}},648:(o,l,e)=>{var n=e(1694),s=e(614),t=e(4326),i=e(5112),d=i("toStringTag"),c=Object,f=t(function(){return arguments}())=="Arguments",v=function(y,C){try{return y[C]}catch{}};o.exports=n?t:function(y){var C,k,I;return y===void 0?"Undefined":y===null?"Null":typeof(k=v(C=c(y),d))=="string"?k:f?t(C):(I=t(C))=="Object"&&s(C.callee)?"Arguments":I}},9920:(o,l,e)=>{var n=e(2597),s=e(3887),t=e(1236),i=e(3070);o.exports=function(d,c,f){for(var v=s(c),y=i.f,C=t.f,k=0;k<v.length;k++){var I=v[k];n(d,I)||f&&n(f,I)||y(d,I,C(c,I))}}},4964:(o,l,e)=>{var n=e(5112),s=n("match");o.exports=function(t){var i=/./;try{"/./"[t](i)}catch{try{return i[s]=!1,"/./"[t](i)}catch{}}return!1}},8880:(o,l,e)=>{var n=e(9781),s=e(3070),t=e(9114);o.exports=n?function(i,d,c){return s.f(i,d,t(1,c))}:function(i,d,c){return i[d]=c,i}},9114:o=>{o.exports=function(l,e){return{enumerable:!(1&l),configurable:!(2&l),writable:!(4&l),value:e}}},6135:(o,l,e)=>{var n=e(4948),s=e(3070),t=e(9114);o.exports=function(i,d,c){var f=n(d);f in i?s.f(i,f,t(0,c)):i[f]=c}},8052:(o,l,e)=>{var n=e(614),s=e(3070),t=e(6339),i=e(3072);o.exports=function(d,c,f,v){v||(v={});var y=v.enumerable,C=v.name!==void 0?v.name:c;if(n(f)&&t(f,C,v),v.global)y?d[c]=f:i(c,f);else{try{v.unsafe?d[c]&&(y=!0):delete d[c]}catch{}y?d[c]=f:s.f(d,c,{value:f,enumerable:!1,configurable:!v.nonConfigurable,writable:!v.nonWritable})}return d}},3072:(o,l,e)=>{var n=e(7854),s=Object.defineProperty;o.exports=function(t,i){try{s(n,t,{value:i,configurable:!0,writable:!0})}catch{n[t]=i}return i}},5117:(o,l,e)=>{var n=e(6330),s=TypeError;o.exports=function(t,i){if(!delete t[i])throw s("Cannot delete property "+n(i)+" of "+n(t))}},9781:(o,l,e)=>{var n=e(7293);o.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:(o,l,e)=>{var n=e(7854),s=e(111),t=n.document,i=s(t)&&s(t.createElement);o.exports=function(d){return i?t.createElement(d):{}}},7207:o=>{var l=TypeError,e=9007199254740991;o.exports=function(n){if(n>e)throw l("Maximum allowed index exceeded");return n}},8113:(o,l,e)=>{var n=e(5005);o.exports=n("navigator","userAgent")||""},7392:(o,l,e)=>{var n,s,t=e(7854),i=e(8113),d=t.process,c=t.Deno,f=d&&d.versions||c&&c.version,v=f&&f.v8;v&&(n=v.split("."),s=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!s&&i&&(n=i.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=i.match(/Chrome\/(\d+)/),n&&(s=+n[1]))),o.exports=s},748:o=>{o.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},7762:(o,l,e)=>{var n=e(9781),s=e(7293),t=e(9670),i=e(30),d=e(6277),c=Error.prototype.toString,f=s(function(){if(n){var v=i(Object.defineProperty({},"name",{get:function(){return this===v}}));if(c.call(v)!=="true")return!0}return c.call({message:1,name:2})!=="2: 1"||c.call({})!=="Error"});o.exports=f?function(){var v=t(this),y=d(v.name,"Error"),C=d(v.message);return y?C?y+": "+C:y:C}:c},2109:(o,l,e)=>{var n=e(7854),s=e(1236).f,t=e(8880),i=e(8052),d=e(3072),c=e(9920),f=e(4705);o.exports=function(v,y){var C,k,I,_,M,$,z=v.target,X=v.global,U=v.stat;if(k=X?n:U?n[z]||d(z,{}):(n[z]||{}).prototype,k)for(I in y){if(M=y[I],v.dontCallGetSet?($=s(k,I),_=$&&$.value):_=k[I],C=f(X?I:z+(U?".":"#")+I,v.forced),!C&&_!==void 0){if(typeof M==typeof _)continue;c(M,_)}(v.sham||_&&_.sham)&&t(M,"sham",!0),i(k,I,M,v)}}},7293:o=>{o.exports=function(l){try{return!!l()}catch{return!0}}},2104:(o,l,e)=>{var n=e(4374),s=Function.prototype,t=s.apply,i=s.call;o.exports=typeof Reflect=="object"&&Reflect.apply||(n?i.bind(t):function(){return i.apply(t,arguments)})},9974:(o,l,e)=>{var n=e(1702),s=e(9662),t=e(4374),i=n(n.bind);o.exports=function(d,c){return s(d),c===void 0?d:t?i(d,c):function(){return d.apply(c,arguments)}}},4374:(o,l,e)=>{var n=e(7293);o.exports=!n(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")})},6916:(o,l,e)=>{var n=e(4374),s=Function.prototype.call;o.exports=n?s.bind(s):function(){return s.apply(s,arguments)}},6530:(o,l,e)=>{var n=e(9781),s=e(2597),t=Function.prototype,i=n&&Object.getOwnPropertyDescriptor,d=s(t,"name"),c=d&&(function(){}).name==="something",f=d&&(!n||n&&i(t,"name").configurable);o.exports={EXISTS:d,PROPER:c,CONFIGURABLE:f}},1702:(o,l,e)=>{var n=e(4374),s=Function.prototype,t=s.bind,i=s.call,d=n&&t.bind(i,i);o.exports=n?function(c){return c&&d(c)}:function(c){return c&&function(){return i.apply(c,arguments)}}},5005:(o,l,e)=>{var n=e(7854),s=e(614),t=function(i){return s(i)?i:void 0};o.exports=function(i,d){return arguments.length<2?t(n[i]):n[i]&&n[i][d]}},8173:(o,l,e)=>{var n=e(9662),s=e(8554);o.exports=function(t,i){var d=t[i];return s(d)?void 0:n(d)}},7854:(o,l,e)=>{var n=function(s){return s&&s.Math==Math&&s};o.exports=n(typeof globalThis=="object"&&globalThis)||n(typeof window=="object"&&window)||n(typeof self=="object"&&self)||n(typeof e.g=="object"&&e.g)||function(){return this}()||Function("return this")()},2597:(o,l,e)=>{var n=e(1702),s=e(7908),t=n({}.hasOwnProperty);o.exports=Object.hasOwn||function(i,d){return t(s(i),d)}},3501:o=>{o.exports={}},490:(o,l,e)=>{var n=e(5005);o.exports=n("document","documentElement")},4664:(o,l,e)=>{var n=e(9781),s=e(7293),t=e(317);o.exports=!n&&!s(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!=7})},8361:(o,l,e)=>{var n=e(1702),s=e(7293),t=e(4326),i=Object,d=n("".split);o.exports=s(function(){return!i("z").propertyIsEnumerable(0)})?function(c){return t(c)=="String"?d(c,""):i(c)}:i},9587:(o,l,e)=>{var n=e(614),s=e(111),t=e(7674);o.exports=function(i,d,c){var f,v;return t&&n(f=d.constructor)&&f!==c&&s(v=f.prototype)&&v!==c.prototype&&t(i,v),i}},2788:(o,l,e)=>{var n=e(1702),s=e(614),t=e(5465),i=n(Function.toString);s(t.inspectSource)||(t.inspectSource=function(d){return i(d)}),o.exports=t.inspectSource},9909:(o,l,e)=>{var n,s,t,i=e(4811),d=e(7854),c=e(1702),f=e(111),v=e(8880),y=e(2597),C=e(5465),k=e(6200),I=e(3501),_="Object already initialized",M=d.TypeError,$=d.WeakMap,z=function(T){return t(T)?s(T):n(T,{})},X=function(T){return function(D){var oe;if(!f(D)||(oe=s(D)).type!==T)throw M("Incompatible receiver, "+T+" required");return oe}};if(i||C.state){var U=C.state||(C.state=new $),J=c(U.get),H=c(U.has),ee=c(U.set);n=function(T,D){if(H(U,T))throw M(_);return D.facade=T,ee(U,T,D),D},s=function(T){return J(U,T)||{}},t=function(T){return H(U,T)}}else{var le=k("state");I[le]=!0,n=function(T,D){if(y(T,le))throw M(_);return D.facade=T,v(T,le,D),D},s=function(T){return y(T,le)?T[le]:{}},t=function(T){return y(T,le)}}o.exports={set:n,get:s,has:t,enforce:z,getterFor:X}},3157:(o,l,e)=>{var n=e(4326);o.exports=Array.isArray||function(s){return n(s)=="Array"}},614:o=>{o.exports=function(l){return typeof l=="function"}},4411:(o,l,e)=>{var n=e(1702),s=e(7293),t=e(614),i=e(648),d=e(5005),c=e(2788),f=function(){},v=[],y=d("Reflect","construct"),C=/^\s*(?:class|function)\b/,k=n(C.exec),I=!C.exec(f),_=function($){if(!t($))return!1;try{return y(f,v,$),!0}catch{return!1}},M=function($){if(!t($))return!1;switch(i($)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return I||!!k(C,c($))}catch{return!0}};M.sham=!0,o.exports=!y||s(function(){var $;return _(_.call)||!_(Object)||!_(function(){$=!0})||$})?M:_},4705:(o,l,e)=>{var n=e(7293),s=e(614),t=/#|\.prototype\./,i=function(y,C){var k=c[d(y)];return k==v||k!=f&&(s(C)?n(C):!!C)},d=i.normalize=function(y){return String(y).replace(t,".").toLowerCase()},c=i.data={},f=i.NATIVE="N",v=i.POLYFILL="P";o.exports=i},8554:o=>{o.exports=function(l){return l==null}},111:(o,l,e)=>{var n=e(614),s=typeof document=="object"&&document.all,t=typeof s>"u"&&s!==void 0;o.exports=t?function(i){return typeof i=="object"?i!==null:n(i)||i===s}:function(i){return typeof i=="object"?i!==null:n(i)}},1913:o=>{o.exports=!1},7850:(o,l,e)=>{var n=e(111),s=e(4326),t=e(5112),i=t("match");o.exports=function(d){var c;return n(d)&&((c=d[i])!==void 0?!!c:s(d)=="RegExp")}},2190:(o,l,e)=>{var n=e(5005),s=e(614),t=e(7976),i=e(3307),d=Object;o.exports=i?function(c){return typeof c=="symbol"}:function(c){var f=n("Symbol");return s(f)&&t(f.prototype,d(c))}},6244:(o,l,e)=>{var n=e(7466);o.exports=function(s){return n(s.length)}},6339:(o,l,e)=>{var n=e(7293),s=e(614),t=e(2597),i=e(9781),d=e(6530).CONFIGURABLE,c=e(2788),f=e(9909),v=f.enforce,y=f.get,C=Object.defineProperty,k=i&&!n(function(){return C(function(){},"length",{value:8}).length!==8}),I=String(String).split("String"),_=o.exports=function(M,$,z){String($).slice(0,7)==="Symbol("&&($="["+String($).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),z&&z.getter&&($="get "+$),z&&z.setter&&($="set "+$),(!t(M,"name")||d&&M.name!==$)&&(i?C(M,"name",{value:$,configurable:!0}):M.name=$),k&&z&&t(z,"arity")&&M.length!==z.arity&&C(M,"length",{value:z.arity});try{z&&t(z,"constructor")&&z.constructor?i&&C(M,"prototype",{writable:!1}):M.prototype&&(M.prototype=void 0)}catch{}var X=v(M);return t(X,"source")||(X.source=I.join(typeof $=="string"?$:"")),M};Function.prototype.toString=_(function(){return s(this)&&y(this).source||c(this)},"toString")},4758:o=>{var l=Math.ceil,e=Math.floor;o.exports=Math.trunc||function(n){var s=+n;return(s>0?e:l)(s)}},6277:(o,l,e)=>{var n=e(1340);o.exports=function(s,t){return s===void 0?arguments.length<2?"":t:n(s)}},3929:(o,l,e)=>{var n=e(7850),s=TypeError;o.exports=function(t){if(n(t))throw s("The method doesn't accept regular expressions");return t}},30:(o,l,e)=>{var n,s=e(9670),t=e(6048),i=e(748),d=e(3501),c=e(490),f=e(317),v=e(6200),y=">",C="<",k="prototype",I="script",_=v("IE_PROTO"),M=function(){},$=function(J){return C+I+y+J+C+"/"+I+y},z=function(J){J.write($("")),J.close();var H=J.parentWindow.Object;return J=null,H},X=function(){var J,H=f("iframe"),ee="java"+I+":";return H.style.display="none",c.appendChild(H),H.src=String(ee),J=H.contentWindow.document,J.open(),J.write($("document.F=Object")),J.close(),J.F},U=function(){try{n=new ActiveXObject("htmlfile")}catch{}U=typeof document<"u"?document.domain&&n?z(n):X():z(n);for(var J=i.length;J--;)delete U[k][i[J]];return U()};d[_]=!0,o.exports=Object.create||function(J,H){var ee;return J!==null?(M[k]=s(J),ee=new M,M[k]=null,ee[_]=J):ee=U(),H===void 0?ee:t.f(ee,H)}},6048:(o,l,e)=>{var n=e(9781),s=e(3353),t=e(3070),i=e(9670),d=e(5656),c=e(1956);l.f=n&&!s?Object.defineProperties:function(f,v){i(f);for(var y,C=d(v),k=c(v),I=k.length,_=0;I>_;)t.f(f,y=k[_++],C[y]);return f}},3070:(o,l,e)=>{var n=e(9781),s=e(4664),t=e(3353),i=e(9670),d=e(4948),c=TypeError,f=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y="enumerable",C="configurable",k="writable";l.f=n?t?function(I,_,M){if(i(I),_=d(_),i(M),typeof I=="function"&&_==="prototype"&&"value"in M&&k in M&&!M[k]){var $=v(I,_);$&&$[k]&&(I[_]=M.value,M={configurable:C in M?M[C]:$[C],enumerable:y in M?M[y]:$[y],writable:!1})}return f(I,_,M)}:f:function(I,_,M){if(i(I),_=d(_),i(M),s)try{return f(I,_,M)}catch{}if("get"in M||"set"in M)throw c("Accessors not supported");return"value"in M&&(I[_]=M.value),I}},1236:(o,l,e)=>{var n=e(9781),s=e(6916),t=e(5296),i=e(9114),d=e(5656),c=e(4948),f=e(2597),v=e(4664),y=Object.getOwnPropertyDescriptor;l.f=n?y:function(C,k){if(C=d(C),k=c(k),v)try{return y(C,k)}catch{}if(f(C,k))return i(!s(t.f,C,k),C[k])}},8006:(o,l,e)=>{var n=e(6324),s=e(748),t=s.concat("length","prototype");l.f=Object.getOwnPropertyNames||function(i){return n(i,t)}},5181:(o,l)=>{l.f=Object.getOwnPropertySymbols},7976:(o,l,e)=>{var n=e(1702);o.exports=n({}.isPrototypeOf)},6324:(o,l,e)=>{var n=e(1702),s=e(2597),t=e(5656),i=e(1318).indexOf,d=e(3501),c=n([].push);o.exports=function(f,v){var y,C=t(f),k=0,I=[];for(y in C)!s(d,y)&&s(C,y)&&c(I,y);for(;v.length>k;)s(C,y=v[k++])&&(~i(I,y)||c(I,y));return I}},1956:(o,l,e)=>{var n=e(6324),s=e(748);o.exports=Object.keys||function(t){return n(t,s)}},5296:(o,l)=>{var e={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!e.call({1:2},1);l.f=s?function(t){var i=n(this,t);return!!i&&i.enumerable}:e},7674:(o,l,e)=>{var n=e(1702),s=e(9670),t=e(6077);o.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var i,d=!1,c={};try{i=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),i(c,[]),d=c instanceof Array}catch{}return function(f,v){return s(f),t(v),d?i(f,v):f.__proto__=v,f}}():void 0)},288:(o,l,e)=>{var n=e(1694),s=e(648);o.exports=n?{}.toString:function(){return"[object "+s(this)+"]"}},2140:(o,l,e)=>{var n=e(6916),s=e(614),t=e(111),i=TypeError;o.exports=function(d,c){var f,v;if(c==="string"&&s(f=d.toString)&&!t(v=n(f,d))||s(f=d.valueOf)&&!t(v=n(f,d))||c!=="string"&&s(f=d.toString)&&!t(v=n(f,d)))return v;throw i("Can't convert object to primitive value")}},3887:(o,l,e)=>{var n=e(5005),s=e(1702),t=e(8006),i=e(5181),d=e(9670),c=s([].concat);o.exports=n("Reflect","ownKeys")||function(f){var v=t.f(d(f)),y=i.f;return y?c(v,y(f)):v}},7066:(o,l,e)=>{var n=e(9670);o.exports=function(){var s=n(this),t="";return s.hasIndices&&(t+="d"),s.global&&(t+="g"),s.ignoreCase&&(t+="i"),s.multiline&&(t+="m"),s.dotAll&&(t+="s"),s.unicode&&(t+="u"),s.unicodeSets&&(t+="v"),s.sticky&&(t+="y"),t}},4706:(o,l,e)=>{var n=e(6916),s=e(2597),t=e(7976),i=e(7066),d=RegExp.prototype;o.exports=function(c){var f=c.flags;return f!==void 0||"flags"in d||s(c,"flags")||!t(d,c)?f:n(i,c)}},4488:(o,l,e)=>{var n=e(8554),s=TypeError;o.exports=function(t){if(n(t))throw s("Can't call method on "+t);return t}},7152:(o,l,e)=>{var n=e(7854),s=e(2104),t=e(614),i=e(8113),d=e(206),c=e(8053),f=/MSIE .\./.test(i),v=n.Function,y=function(C){return f?function(k,I){var _=c(arguments.length,1)>2,M=t(k)?k:v(k),$=_?d(arguments,2):void 0;return C(_?function(){s(M,this,$)}:M,I)}:C};o.exports={setTimeout:y(n.setTimeout),setInterval:y(n.setInterval)}},6200:(o,l,e)=>{var n=e(2309),s=e(9711),t=n("keys");o.exports=function(i){return t[i]||(t[i]=s(i))}},5465:(o,l,e)=>{var n=e(7854),s=e(3072),t="__core-js_shared__",i=n[t]||s(t,{});o.exports=i},2309:(o,l,e)=>{var n=e(1913),s=e(5465);(o.exports=function(t,i){return s[t]||(s[t]=i!==void 0?i:{})})("versions",[]).push({version:"3.25.0",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})},3111:(o,l,e)=>{var n=e(1702),s=e(4488),t=e(1340),i=e(1361),d=n("".replace),c="["+i+"]",f=RegExp("^"+c+c+"*"),v=RegExp(c+c+"*$"),y=function(C){return function(k){var I=t(s(k));return 1&C&&(I=d(I,f,"")),2&C&&(I=d(I,v,"")),I}};o.exports={start:y(1),end:y(2),trim:y(3)}},6293:(o,l,e)=>{var n=e(7392),s=e(7293);o.exports=!!Object.getOwnPropertySymbols&&!s(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41})},863:(o,l,e)=>{var n=e(1702);o.exports=n(1 .valueOf)},1400:(o,l,e)=>{var n=e(9303),s=Math.max,t=Math.min;o.exports=function(i,d){var c=n(i);return c<0?s(c+d,0):t(c,d)}},5656:(o,l,e)=>{var n=e(8361),s=e(4488);o.exports=function(t){return n(s(t))}},9303:(o,l,e)=>{var n=e(4758);o.exports=function(s){var t=+s;return t!==t||t===0?0:n(t)}},7466:(o,l,e)=>{var n=e(9303),s=Math.min;o.exports=function(t){return t>0?s(n(t),9007199254740991):0}},7908:(o,l,e)=>{var n=e(4488),s=Object;o.exports=function(t){return s(n(t))}},7593:(o,l,e)=>{var n=e(6916),s=e(111),t=e(2190),i=e(8173),d=e(2140),c=e(5112),f=TypeError,v=c("toPrimitive");o.exports=function(y,C){if(!s(y)||t(y))return y;var k,I=i(y,v);if(I){if(C===void 0&&(C="default"),k=n(I,y,C),!s(k)||t(k))return k;throw f("Can't convert object to primitive value")}return C===void 0&&(C="number"),d(y,C)}},4948:(o,l,e)=>{var n=e(7593),s=e(2190);o.exports=function(t){var i=n(t,"string");return s(i)?i:i+""}},1694:(o,l,e)=>{var n=e(5112),s=n("toStringTag"),t={};t[s]="z",o.exports=String(t)==="[object z]"},1340:(o,l,e)=>{var n=e(648),s=String;o.exports=function(t){if(n(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s(t)}},6330:o=>{var l=String;o.exports=function(e){try{return l(e)}catch{return"Object"}}},9711:(o,l,e)=>{var n=e(1702),s=0,t=Math.random(),i=n(1 .toString);o.exports=function(d){return"Symbol("+(d===void 0?"":d)+")_"+i(++s+t,36)}},3307:(o,l,e)=>{var n=e(6293);o.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(o,l,e)=>{var n=e(9781),s=e(7293);o.exports=n&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},8053:o=>{var l=TypeError;o.exports=function(e,n){if(e<n)throw l("Not enough arguments");return e}},4811:(o,l,e)=>{var n=e(7854),s=e(614),t=n.WeakMap;o.exports=s(t)&&/native code/.test(String(t))},5112:(o,l,e)=>{var n=e(7854),s=e(2309),t=e(2597),i=e(9711),d=e(6293),c=e(3307),f=s("wks"),v=n.Symbol,y=v&&v.for,C=c?v:v&&v.withoutSetter||i;o.exports=function(k){if(!t(f,k)||!d&&typeof f[k]!="string"){var I="Symbol."+k;d&&t(v,k)?f[k]=v[k]:f[k]=c&&y?y(I):C(I)}return f[k]}},1361:o=>{o.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},9554:(o,l,e)=>{var n=e(2109),s=e(8533);n({target:"Array",proto:!0,forced:[].forEach!=s},{forEach:s})},6699:(o,l,e)=>{var n=e(2109),s=e(1318).includes,t=e(7293),i=e(1223),d=t(function(){return!Array(1).includes()});n({target:"Array",proto:!0,forced:d},{includes:function(c){return s(this,c,arguments.length>1?arguments[1]:void 0)}}),i("includes")},2772:(o,l,e)=>{var n=e(2109),s=e(1702),t=e(1318).indexOf,i=e(9341),d=s([].indexOf),c=!!d&&1/d([1],1,-0)<0,f=i("indexOf");n({target:"Array",proto:!0,forced:c||!f},{indexOf:function(v){var y=arguments.length>1?arguments[1]:void 0;return c?d(this,v,y)||0:t(this,v,y)}})},561:(o,l,e)=>{var n=e(2109),s=e(7908),t=e(1400),i=e(9303),d=e(6244),c=e(3658),f=e(7207),v=e(5417),y=e(6135),C=e(5117),k=e(1194),I=k("splice"),_=Math.max,M=Math.min;n({target:"Array",proto:!0,forced:!I},{splice:function($,z){var X,U,J,H,ee,le,T=s(this),D=d(T),oe=t($,D),_e=arguments.length;for(_e===0?X=U=0:_e===1?(X=0,U=D-oe):(X=_e-2,U=M(_(i(z),0),D-oe)),f(D+X-U),J=v(T,U),H=0;H<U;H++)ee=oe+H,ee in T&&y(J,H,T[ee]);if(J.length=U,X<U){for(H=oe;H<D-U;H++)ee=H+U,le=H+X,ee in T?T[le]=T[ee]:C(T,le);for(H=D;H>D-U+X;H--)C(T,H-1)}else if(X>U)for(H=D-U;H>oe;H--)ee=H+U-1,le=H+X-1,ee in T?T[le]=T[ee]:C(T,le);for(H=0;H<X;H++)T[H+oe]=arguments[H+2];return c(T,D-U+X),J}})},3710:(o,l,e)=>{var n=e(1702),s=e(8052),t=Date.prototype,i="Invalid Date",d="toString",c=n(t[d]),f=n(t.getTime);String(new Date(NaN))!=i&&s(t,d,function(){var v=f(this);return v===v?c(this):i})},6647:(o,l,e)=>{var n=e(8052),s=e(7762),t=Error.prototype;t.toString!==s&&n(t,"toString",s)},9653:(o,l,e)=>{var n=e(9781),s=e(7854),t=e(1702),i=e(4705),d=e(8052),c=e(2597),f=e(9587),v=e(7976),y=e(2190),C=e(7593),k=e(7293),I=e(8006).f,_=e(1236).f,M=e(3070).f,$=e(863),z=e(3111).trim,X="Number",U=s[X],J=U.prototype,H=s.TypeError,ee=t("".slice),le=t("".charCodeAt),T=function(Y){var G=C(Y,"number");return typeof G=="bigint"?G:D(G)},D=function(Y){var G,K,ke,we,Me,Se,Ee,Xe,Ie=C(Y,"number");if(y(Ie))throw H("Cannot convert a Symbol value to a number");if(typeof Ie=="string"&&Ie.length>2){if(Ie=z(Ie),G=le(Ie,0),G===43||G===45){if(K=le(Ie,2),K===88||K===120)return NaN}else if(G===48){switch(le(Ie,1)){case 66:case 98:ke=2,we=49;break;case 79:case 111:ke=8,we=55;break;default:return+Ie}for(Me=ee(Ie,2),Se=Me.length,Ee=0;Ee<Se;Ee++)if(Xe=le(Me,Ee),Xe<48||Xe>we)return NaN;return parseInt(Me,ke)}}return+Ie};if(i(X,!U(" 0o1")||!U("0b1")||U("+0x1"))){for(var oe,_e=function(Y){var G=arguments.length<1?0:U(T(Y)),K=this;return v(J,K)&&k(function(){$(K)})?f(Object(G),K,_e):G},S=n?I(U):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),P=0;S.length>P;P++)c(U,oe=S[P])&&!c(_e,oe)&&M(_e,oe,_(U,oe));_e.prototype=J,J.constructor=_e,d(s,X,_e,{constructor:!0})}},1539:(o,l,e)=>{var n=e(1694),s=e(8052),t=e(288);n||s(Object.prototype,"toString",t,{unsafe:!0})},9714:(o,l,e)=>{var n=e(6530).PROPER,s=e(8052),t=e(9670),i=e(1340),d=e(7293),c=e(4706),f="toString",v=RegExp.prototype,y=v[f],C=d(function(){return y.call({source:"a",flags:"b"})!="/a/b"}),k=n&&y.name!=f;(C||k)&&s(RegExp.prototype,f,function(){var I=t(this),_=i(I.source),M=i(c(I));return"/"+_+"/"+M},{unsafe:!0})},2023:(o,l,e)=>{var n=e(2109),s=e(1702),t=e(3929),i=e(4488),d=e(1340),c=e(4964),f=s("".indexOf);n({target:"String",proto:!0,forced:!c("includes")},{includes:function(v){return!!~f(d(i(this)),d(t(v)),arguments.length>1?arguments[1]:void 0)}})},6815:(o,l,e)=>{var n=e(2109),s=e(7854),t=e(7152).setInterval;n({global:!0,bind:!0,forced:s.setInterval!==t},{setInterval:t})},8417:(o,l,e)=>{var n=e(2109),s=e(7854),t=e(7152).setTimeout;n({global:!0,bind:!0,forced:s.setTimeout!==t},{setTimeout:t})},2564:(o,l,e)=>{e(6815),e(8417)},3744:(o,l)=>{l.Z=(e,n)=>{const s=e.__vccOpts||e;for(const[t,i]of n)s[t]=i;return s}},7203:o=>{o.exports=u}},g={};function h(o){var l=g[o];if(l!==void 0)return l.exports;var e=g[o]={exports:{}};return p[o](e,e.exports,h),e.exports}h.d=(o,l)=>{for(var e in l)h.o(l,e)&&!h.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:l[e]})},h.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),h.o=(o,l)=>Object.prototype.hasOwnProperty.call(o,l),h.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},h.p="";var b={};return(()=>{if(h.r(b),h.d(b,{ContextMenu:()=>Pn,ContextMenuGroup:()=>zn,ContextMenuItem:()=>Ct,ContextMenuSeparator:()=>ue,MenuBar:()=>qo,default:()=>Yo}),typeof window<"u"){var o=window.document.currentScript,l=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(h.p=l[1])}var e=h(7203),n=null;function s(m){n&&i(),n=m}function t(m){m===n&&(n=null)}function i(){n&&(n.closeMenu(),n=null)}h(6647),h(3710),h(1539),h(9714);var d={defaultDirection:"br",defaultMinWidth:100,defaultMaxWidth:600,defaultZindex:100,defaultAdjustPadding:{x:0,y:10}};function c(m,w){var R=m.offsetTop;return m.offsetParent!=null&&m.offsetParent!=w&&(R-=m.offsetParent.scrollTop,R+=c(m.offsetParent,w)),R}function f(m,w){var R=m.offsetLeft;return m.offsetParent!=null&&m.offsetParent!=w&&(R-=m.offsetParent.scrollLeft,R+=f(m.offsetParent,w)),R}function v(m,w,R,V){return{x:f(m,V)+w,y:c(m,V)+R}}var y="mx-menu-default-container",C="mx-menu-container-",k=0;function I(m){var w=m.getContainer,R=m.zIndex;if(w){var V=typeof w=="function"?w():w;if(V){var pe=V.getAttribute("id");return pe||(pe=C+k++,V.setAttribute("id",pe)),V.style.zIndex=(R==null?void 0:R.toString())||d.defaultZindex.toString(),{eleId:pe,container:V,isNew:!1}}}var he=document.getElementById(y);return he||(he=document.createElement("div"),he.setAttribute("id",y),he.setAttribute("class","mx-menu-ghost-host fullscreen"),document.body.appendChild(he)),he.style.zIndex=(R==null?void 0:R.toString())||d.defaultZindex.toString(),{eleId:y,container:he,isNew:!0}}function _(m){return typeof m=="number"?"".concat(m,"px"):m}var M=(0,e.defineComponent)({props:{vnode:{type:[Object,Function],default:null},data:{type:Object,default:null}},setup:function(m){var w=(0,e.toRefs)(m),R=w.vnode,V=w.data;return function(){return typeof R.value=="function"?R.value(V.value):R.value}}});function $(m,w,R){return w in m?Object.defineProperty(m,w,{value:R,enumerable:!0,configurable:!0,writable:!0}):m[w]=R,m}function z(m,w){var R=Object.keys(m);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(m);w&&(V=V.filter(function(pe){return Object.getOwnPropertyDescriptor(m,pe).enumerable})),R.push.apply(R,V)}return R}function X(m){for(var w=1;w<arguments.length;w++){var R=arguments[w]!=null?arguments[w]:{};w%2?z(Object(R),!0).forEach(function(V){$(m,V,R[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(R)):z(Object(R)).forEach(function(V){Object.defineProperty(m,V,Object.getOwnPropertyDescriptor(R,V))})}return m}h(2564);var U={class:"mx-context-menu-scroll",ref:"scroll"};function J(m,w,R,V,pe,he){var re=(0,e.resolveComponent)("ContextMenuSeparator"),te=(0,e.resolveComponent)("ContextSubMenu",!0),ce=(0,e.resolveComponent)("ContextMenuItem"),Oe=(0,e.resolveComponent)("ContextMenuIconRight");return(0,e.openBlock)(),(0,e.createElementBlock)("div",{class:(0,e.normalizeClass)("mx-context-menu "+(m.options.customClass?m.options.customClass:"")+" "+m.globalTheme),style:(0,e.normalizeStyle)({maxWidth:m.maxWidth?m.solveNumberOrStringSize(m.maxWidth):"".concat(m.constOptions.defaultMaxWidth,"px"),minWidth:m.minWidth?m.solveNumberOrStringSize(m.minWidth):"".concat(m.constOptions.defaultMinWidth,"px"),maxHeight:m.overflow&&m.maxHeight>0?"".concat(m.maxHeight,"px"):void 0,zIndex:m.zIndex,left:"".concat(m.position.x,"px"),top:"".concat(m.position.y,"px")}),"data-type":"ContextSubMenu",onClick:w[2]||(w[2]=function(){return m.onSubMenuBodyClick&&m.onSubMenuBodyClick.apply(m,arguments)})},[(0,e.createElementVNode)("div",{class:"mx-context-menu-items",ref:"menu",style:(0,e.normalizeStyle)({top:"".concat(m.scrollValue,"px")})},[(0,e.renderSlot)(m.$slots,"default",{},function(){return[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(m.items,function(F,Ce){return(0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:Ce},[F.hidden!==!0&&F.divided==="up"?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0})):(0,e.createCommentVNode)("",!0),F.hidden!==!0&&F.divided==="self"?((0,e.openBlock)(),(0,e.createBlock)(re,{key:1})):((0,e.openBlock)(),(0,e.createBlock)(ce,{key:2,clickHandler:F.onClick?function($e){return F.onClick($e)}:void 0,disabled:F.disabled,hidden:F.hidden,icon:F.icon,iconFontClass:F.iconFontClass,svgIcon:F.svgIcon,svgProps:F.svgProps,label:F.label,customRender:F.customRender,customClass:F.customClass,checked:F.checked,shortcut:F.shortcut,clickClose:F.clickClose,clickableWhenHasChildren:F.clickableWhenHasChildren,preserveIconWidth:F.preserveIconWidth!==void 0?F.preserveIconWidth:m.options.preserveIconWidth,showRightArrow:F.children&&F.children.length>0,hasChildren:F.children&&F.children.length>0,rawMenuItem:F,onSubMenuOpen:F.onSubMenuOpen,onSubMenuClose:F.onSubMenuClose},(0,e.createSlots)({_:2},[F.children&&F.children.length>0?{name:"submenu",fn:(0,e.withCtx)(function(){return[(0,e.createVNode)(te,{items:F.children,maxWidth:F.maxWidth,minWidth:F.minWidth,adjustPosition:F.adjustSubMenuPosition!==void 0?F.adjustSubMenuPosition:m.options.adjustPosition,direction:F.direction!==void 0?F.direction:m.options.direction},null,8,["items","maxWidth","minWidth","adjustPosition","direction"])]}),key:"0"}:void 0]),1032,["clickHandler","disabled","hidden","icon","iconFontClass","svgIcon","svgProps","label","customRender","customClass","checked","shortcut","clickClose","clickableWhenHasChildren","preserveIconWidth","showRightArrow","hasChildren","rawMenuItem","onSubMenuOpen","onSubMenuClose"])),F.hidden===!0||F.divided!=="down"&&F.divided!==!0?(0,e.createCommentVNode)("",!0):((0,e.openBlock)(),(0,e.createBlock)(re,{key:3}))],64)}),128))]})],4),(0,e.createElementVNode)("div",U,[(0,e.withDirectives)((0,e.createElementVNode)("div",{class:"mx-context-menu-updown mx-context-no-clickable up",onClick:w[0]||(w[0]=function(F){return m.onScroll(!1)})},[(0,e.createVNode)(Oe)],512),[[e.vShow,m.overflow&&m.scrollValue<0]]),(0,e.withDirectives)((0,e.createElementVNode)("div",{class:"mx-context-menu-updown mx-context-no-clickable down",onClick:w[1]||(w[1]=function(F){return m.onScroll(!0)})},[(0,e.createVNode)(Oe)],512),[[e.vShow,m.overflow&&m.scrollValue>-m.scrollHeight]])],512)],6)}h(9653),h(2772),h(9554),h(561),h(6699),h(2023);var H={key:0,class:"mx-context-menu-item-wrapper",ref:"menuItemRef","data-type":"ContextMenuItem"},ee={class:"mx-item-row"},le=["xlink:href"],T={key:1,class:"label"},D={class:"mx-item-row"},oe={class:"mx-shortcut"};function _e(m,w,R,V,pe,he){var re=(0,e.resolveComponent)("VNodeRender"),te=(0,e.resolveComponent)("ContextMenuIconCheck"),ce=(0,e.resolveComponent)("ContextMenuIconRight");return m.hidden?(0,e.createCommentVNode)("",!0):((0,e.openBlock)(),(0,e.createElementBlock)("div",H,[m.globalHasSlot("itemRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("itemRender",m.getItemDataForChildren())}},null,8,["vnode"])):m.customRender?((0,e.openBlock)(),(0,e.createBlock)(re,{key:1,vnode:m.customRender,data:m.getItemDataForChildren()},null,8,["vnode","data"])):((0,e.openBlock)(),(0,e.createElementBlock)("div",{key:2,class:(0,e.normalizeClass)(["mx-context-menu-item",m.disabled?"disabled":"",m.keyBoardFocusMenu?"keyboard-focus":"",m.customClass?" "+m.customClass:"",m.showSubMenu?"open":""]),onClick:w[0]||(w[0]=function(){return m.onClick&&m.onClick.apply(m,arguments)}),onMouseenter:w[1]||(w[1]=function(){return m.onMouseEnter&&m.onMouseEnter.apply(m,arguments)})},[(0,e.renderSlot)(m.$slots,"default",{},function(){return[(0,e.createElementVNode)("div",ee,[(0,e.createElementVNode)("div",{class:(0,e.normalizeClass)(["mx-icon-placeholder",m.preserveIconWidth?"preserve-width":""])},[(0,e.renderSlot)(m.$slots,"icon",{},function(){return[m.globalHasSlot("itemIconRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("itemIconRender",m.getItemDataForChildren())}},null,8,["vnode"])):typeof m.svgIcon=="string"&&m.svgIcon?((0,e.openBlock)(),(0,e.createElementBlock)("svg",(0,e.mergeProps)({key:1,class:"icon svg"},m.svgProps),[(0,e.createElementVNode)("use",{"xlink:href":m.svgIcon},null,8,le)],16)):typeof m.icon!="string"?((0,e.openBlock)(),(0,e.createBlock)(re,{key:2,vnode:m.icon,data:m.icon},null,8,["vnode","data"])):typeof m.icon=="string"&&m.icon!==""?((0,e.openBlock)(),(0,e.createElementBlock)("i",{key:3,class:(0,e.normalizeClass)(m.icon+" icon "+m.iconFontClass+" "+m.globalIconFontClass)},null,2)):(0,e.createCommentVNode)("",!0)]}),m.checked?(0,e.renderSlot)(m.$slots,"check",{key:0},function(){return[m.globalHasSlot("itemCheckRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("itemCheckRender",m.getItemDataForChildren())}},null,8,["vnode"])):(0,e.createCommentVNode)("",!0),(0,e.createVNode)(te)]}):(0,e.createCommentVNode)("",!0)],2),(0,e.renderSlot)(m.$slots,"label",{},function(){return[m.globalHasSlot("itemLabelRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("itemLabelRender",m.getItemDataForChildren())}},null,8,["vnode"])):typeof m.label=="string"?((0,e.openBlock)(),(0,e.createElementBlock)("span",T,(0,e.toDisplayString)(m.label),1)):((0,e.openBlock)(),(0,e.createBlock)(re,{key:2,vnode:m.label,data:m.label},null,8,["vnode","data"]))]})]),(0,e.createElementVNode)("div",D,[m.shortcut?(0,e.renderSlot)(m.$slots,"shortcut",{key:0},function(){return[m.globalHasSlot("itemShortcutRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("itemShortcutRender",m.getItemDataForChildren())}},null,8,["vnode"])):(0,e.createCommentVNode)("",!0),(0,e.createElementVNode)("span",oe,(0,e.toDisplayString)(m.shortcut),1)]}):(0,e.createCommentVNode)("",!0),m.showRightArrow?(0,e.renderSlot)(m.$slots,"rightArrow",{key:1},function(){return[m.globalHasSlot("itemRightArrowRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("itemRightArrowRender",m.getItemDataForChildren())}},null,8,["vnode"])):(0,e.createCommentVNode)("",!0),(0,e.createVNode)(ce)]}):(0,e.createCommentVNode)("",!0)])]})],34)),m.showSubMenu?(0,e.renderSlot)(m.$slots,"submenu",{key:3}):(0,e.createCommentVNode)("",!0)],512))}var S={class:"mx-checked-mark","aria-hidden":"true",viewBox:"0 0 1024 1024"},P=(0,e.createElementVNode)("path",{d:"M129.3,428.6L52,512l345,372.5l575-620.8l-69.5-75L400.4,718.2L129.3,428.6z"},null,-1),Y=[P];function G(m,w){return(0,e.openBlock)(),(0,e.createElementBlock)("svg",S,Y)}var K=h(3744);const ke={},we=(0,K.Z)(ke,[["render",G]]),Me=we;var Se={class:"mx-right-arrow","aria-hidden":"true",viewBox:"0 0 1024 1024"},Ee=(0,e.createElementVNode)("path",{d:"M307.018 49.445c11.517 0 23.032 4.394 31.819 13.18L756.404 480.18c8.439 8.438 13.181 19.885 13.181 31.82s-4.741 23.38-13.181 31.82L338.838 961.376c-17.574 17.573-46.065 17.573-63.64-0.001-17.573-17.573-17.573-46.065 0.001-63.64L660.944 512 275.198 126.265c-17.574-17.573-17.574-46.066-0.001-63.64C283.985 53.839 295.501 49.445 307.018 49.445z"},null,-1),Xe=[Ee];function Ie(m,w){return(0,e.openBlock)(),(0,e.createElementBlock)("svg",Se,Xe)}const Qe={},Rt=(0,K.Z)(Qe,[["render",Ie]]),Vt=Rt,Bt=(0,e.defineComponent)({name:"ContextMenuItem",components:{VNodeRender:M,ContextMenuIconCheck:Me,ContextMenuIconRight:Vt},props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},customRender:{type:Function,default:null},customClass:{type:String,default:""},clickHandler:{type:Function,default:null},label:{type:[String,Object,Function],default:""},icon:{type:[String,Object,Function],default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},hasChildren:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},clickableWhenHasChildren:{type:Boolean,default:!1},rawMenuItem:{type:Object,default:void 0}},emits:["click","subMenuOpen","subMenuClose"],setup:function(m,w){var R=(0,e.toRefs)(m),V=R.clickHandler,pe=R.clickClose,he=R.clickableWhenHasChildren,re=R.disabled,te=R.hidden,ce=R.label,Oe=R.icon,F=R.iconFontClass,Ce=R.showRightArrow,$e=R.shortcut,We=R.hasChildren,je=(0,e.ref)(!1),ne=(0,e.ref)(!1),ae=(0,e.ref)(),Ae=(0,e.inject)("globalHasSlot"),Ue=(0,e.inject)("globalRenderSlot"),dt=(0,e.inject)("globalTheme"),fe=(0,e.inject)("globalIconFontClass"),Ve=(0,e.inject)("globalClickCloseClassName"),et=(0,e.inject)("globalIgnoreClickClassName"),tt=(0,e.inject)("globalCloseMenu"),Re=(0,e.inject)("menuContext"),Ge={showSubMenu:function(){return je.value?(Re.markActiveMenuItem(Ge,!0),!0):!!We.value&&(Ye(),!0)},isDisabledOrHidden:function(){return re.value||te.value},getElement:function(){return ae.value},focus:function(){return ne.value=!0},blur:function(){return ne.value=!1},click:Ke};function Ke(Be){if(!re.value){if(Be){var Fe=Be.target;if(Fe.classList.contains("mx-context-no-clickable")||et&&Fe.classList.contains(et))return;if(Ve&&Fe.classList.contains(Ve))return Be.stopPropagation(),void tt(m.rawMenuItem)}We.value?he.value?(typeof V.value=="function"&&V.value(Be),w.emit("click",Be)):je.value||Ye():(typeof V.value=="function"&&V.value(Be),w.emit("click",Be),pe.value&&tt(m.rawMenuItem))}}function Ye(Be){ne.value=!1,Re.checkCloseOtherSubMenuTimeOut()||Re.closeOtherSubMenu(),re.value||(Re.markActiveMenuItem(Ge),We.value&&(Be||Re.markThisOpenedByKeyBoard(),Re.addOpenedSubMenu(function(){ne.value=!1,je.value=!1,w.emit("subMenuClose")}),je.value=!0,w.emit("subMenuOpen")))}return(0,e.onMounted)(function(){Re.isMenuItemDataCollectedFlag()?(0,e.nextTick)(function(){var Be=0,Fe=Re.getElement();if(Fe)for(var Te=0,Ze=0;Ze<Fe.children.length;Ze++){var W=Fe.children[Ze];if(W.getAttribute("data-type")==="ContextMenuItem"){if(W===ae.value){Be=Te;break}Te++}}Re.addChildMenuItem(Ge,Be)}):Re.addChildMenuItem(Ge)}),(0,e.onBeforeUnmount)(function(){Re.removeChildMenuItem(Ge)}),{getItemDataForChildren:function(){return{disabled:re.value,label:ce.value,icon:Oe.value,iconFontClass:F.value,showRightArrow:Ce.value,clickClose:pe.value,clickableWhenHasChildren:he.value,shortcut:$e.value,theme:dt,isOpen:je,hasChildren:We,onClick:Ke,onMouseEnter:Ye,closeMenu:tt}},showSubMenu:je,keyBoardFocusMenu:ne,menuItemRef:ae,globalHasSlot:Ae,globalRenderSlot:Ue,globalIconFontClass:fe,onMouseEnter:Ye,onClick:Ke}}}),Ht=(0,K.Z)(Bt,[["render",_e]]),Ct=Ht;var an={key:1,class:"mx-context-menu-item-sperator mx-context-no-clickable"};function ln(m,w,R,V,pe,he){var re=(0,e.resolveComponent)("VNodeRender");return m.globalHasSlot("separatorRender")?((0,e.openBlock)(),(0,e.createBlock)(re,{key:0,vnode:function(){return m.globalRenderSlot("separatorRender",{})}},null,8,["vnode"])):((0,e.openBlock)(),(0,e.createElementBlock)("div",an))}const Z=(0,e.defineComponent)({name:"ContextMenuSperator",components:{VNodeRender:M},setup:function(){var m=(0,e.inject)("globalHasSlot"),w=(0,e.inject)("globalRenderSlot");return{globalHasSlot:m,globalRenderSlot:w}}}),N=(0,K.Z)(Z,[["render",ln]]),ue=N,Le=(0,e.defineComponent)({name:"ContextSubMenu",components:{ContextMenuItem:Ct,ContextMenuSeparator:ue,ContextMenuIconRight:Vt},props:{items:{type:Object,default:null},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0},adjustPosition:{type:Boolean,default:!0},direction:{type:String,default:"br"}},setup:function(m){var w=(0,e.inject)("menuContext"),R=(0,e.inject)("globalOptions"),V=(0,e.inject)("globalHasSlot"),pe=(0,e.inject)("globalRenderSlot"),he=(0,e.inject)("globalTheme"),re=w.zIndex,te=w.getParentWidth,ce=w.getParentHeight,Oe=(0,e.toRefs)(m),F=Oe.adjustPosition,Ce=(0,e.ref)(),$e=(0,e.ref)(),We=[],je=(0,e.inject)("globalSetCurrentSubMenu"),ne=[],ae=null,Ae=0;function Ue(){ae&&ae.blur()}function dt(W,ye){if(W){for(var nt=ye!==void 0?ye:0;nt<ne.length;nt++)if(!ne[nt].isDisabledOrHidden()){fe(nt);break}}else for(var vt=ye!==void 0?ye:ne.length-1;vt>=0;vt--)if(!ne[vt].isDisabledOrHidden()){fe(vt);break}}function fe(W){if(ae&&Ue(),W!==void 0&&(ae=ne[Math.max(0,Math.min(W,ne.length-1))]),ae&&(ae.focus(),Fe.value)){var ye=ae.getElement();ye&&(Ke.value=Math.min(Math.max(-Ye.value,-ye.offsetTop-ye.offsetHeight+Ze.value),0))}}function Ve(){je(et)}var et={isTopLevel:function(){return w.getParentContext()===null},closeSelfAndActiveParent:function(){var W=Ge.getParentContext();if(W){W.closeOtherSubMenu();var ye=W.getSubMenuInstanceContext();if(ye)return ye.focusCurrentItem(),!0}return!1},closeCurrentSubMenu:function(){var W;return(W=Ge.getParentContext())===null||W===void 0?void 0:W.closeOtherSubMenu()},moveCurrentItemFirst:function(){return dt(!0)},moveCurrentItemLast:function(){return dt(!1)},moveCurrentItemDown:function(){return dt(!0,ae?ne.indexOf(ae)+1:0)},moveCurrentItemUp:function(){return dt(!1,ae?ne.indexOf(ae)-1:0)},focusCurrentItem:function(){return fe()},openCurrentItemSubMenu:function(){var W;return!!ae&&((W=ae)===null||W===void 0?void 0:W.showSubMenu())},triggerCurrentItemClick:function(W){var ye;return(ye=ae)===null||ye===void 0?void 0:ye.click(W)}},tt=!1,Re=!1,Ge={zIndex:re+1,container:w.container,adjustPadding:R.adjustPadding||d.defaultAdjustPadding,getParentWidth:function(){var W;return((W=Ce.value)===null||W===void 0?void 0:W.offsetWidth)||0},getParentHeight:function(){var W;return((W=Ce.value)===null||W===void 0?void 0:W.offsetHeight)||0},getParentX:function(){return Te.value.x},getParentY:function(){return Te.value.y},getParentAbsX:function(){return Ce.value?f(Ce.value,w.container):0},getParentAbsY:function(){return Ce.value?c(Ce.value,w.container):0},getPositon:function(){return[0,0]},addOpenedSubMenu:function(W){We.push(W)},closeOtherSubMenu:function(){We.forEach(function(W){return W()}),We.splice(0,We.length),je(et)},checkCloseOtherSubMenuTimeOut:function(){return!!Ae&&(clearTimeout(Ae),Ae=0,!0)},closeOtherSubMenuWithTimeOut:function(){var W=this;Ae=setTimeout(function(){Ae=0,W.closeOtherSubMenu()},200)},addChildMenuItem:function(W,ye){ye===void 0?ne.push(W):ne.splice(ye,0,W)},removeChildMenuItem:function(W){ne.splice(ne.indexOf(W),1)},markActiveMenuItem:function(W){var ye=arguments.length>1&&arguments[1]!==void 0&&arguments[1];Ue(),ae=W,ye&&fe()},markThisOpenedByKeyBoard:function(){tt=!0},isOpenedByKeyBoardFlag:function(){return!!tt&&(tt=!1,!0)},isMenuItemDataCollectedFlag:function(){return Re},getElement:function(){return Ce.value||null},getParentContext:function(){return w},getSubMenuInstanceContext:function(){return et}};(0,e.provide)("menuContext",Ge);var Ke=(0,e.ref)(0),Ye=(0,e.ref)(0);function Be(W){Ke.value=W?Math.max(Ke.value-50,-Ye.value):Math.min(Ke.value+50,0)}var Fe=(0,e.ref)(!1),Te=(0,e.ref)({x:0,y:0}),Ze=(0,e.ref)(0);return(0,e.onMounted)(function(){var W,ye,nt,vt,Fn=w.getPositon();Te.value={x:(W=(ye=Fn[0])!==null&&ye!==void 0?ye:R.xOffset)!==null&&W!==void 0?W:0,y:(nt=(vt=Fn[1])!==null&&vt!==void 0?vt:R.yOffset)!==null&&nt!==void 0?nt:0},je(et),(0,e.nextTick)(function(){var Pe=Ce.value;if(Pe&&$e.value){var pn,mn,vn,gn,hn,yn,wt=w.container,bn=(pn=te==null?void 0:te())!==null&&pn!==void 0?pn:0,Zo=(mn=ce==null?void 0:ce())!==null&&mn!==void 0?mn:0,Wt=typeof w.adjustPadding=="number"?w.adjustPadding:(vn=(gn=w.adjustPadding)===null||gn===void 0?void 0:gn.x)!==null&&vn!==void 0?vn:0,Gt=typeof w.adjustPadding=="number"?w.adjustPadding:(hn=(yn=w.adjustPadding)===null||yn===void 0?void 0:yn.y)!==null&&hn!==void 0?hn:0,Kt=Zo>0?Gt:0,Jo=document.documentElement.scrollHeight,Qo=document.documentElement.scrollWidth,er=Math.min(Qo,wt.offsetWidth),_n=Math.min(Jo,wt.offsetHeight),Cn=f(Pe,wt),kn=c(Pe,wt);m.direction.includes("l")?Te.value.x-=Pe.offsetWidth+Wt:m.direction.includes("r")?Te.value.x+=bn+Wt:(Te.value.x+=bn/2,Te.value.x-=(Pe.offsetWidth+Wt)/2),m.direction.includes("t")?Te.value.y-=Pe.offsetHeight+2*Gt:m.direction.includes("b")?Te.value.y-=Gt:Te.value.y-=(Pe.offsetHeight+Gt)/2,F.value&&(0,e.nextTick)(function(){Cn=f(Pe,wt),kn=c(Pe,wt);var tr=Cn+Pe.offsetWidth-er,Un=kn+Pe.offsetHeight-_n;if(Ye.value=Pe.offsetHeight-_n-2*Kt,Fe.value=Un>0,tr>0){var Vn=bn+Pe.offsetWidth-Wt,Hn=Cn;Te.value.x-=Vn>Hn?Hn:Vn}if(Fe.value){var Wn=Un,Gn=kn;Te.value.y-=Wn>Gn?Gn-Kt:Wn-2*Kt,Ze.value=_n-2*Kt}else Ze.value=0})}Pe==null||Pe.focus({preventScroll:!0}),w.isOpenedByKeyBoardFlag()&&dt(!0),Re=!0})}),{menu:Ce,scroll:$e,options:R,zIndex:re,constOptions:d,scrollValue:Ke,overflow:Fe,position:Te,scrollHeight:Ye,maxHeight:Ze,globalHasSlot:V,globalRenderSlot:pe,globalTheme:he,onScroll:Be,onSubMenuBodyClick:Ve,solveNumberOrStringSize:_}}}),xe=(0,K.Z)(Le,[["render",J]]),Nt=xe,un=(0,e.defineComponent)({name:"ContextMenu",emits:["update:show","close"],props:{options:{type:Object,default:null},show:{type:Boolean,default:!1},container:{type:Object,default:null},isFullScreenContainer:{type:Boolean,default:!0}},setup:function(m,w){var R,V,pe,he,re=(0,e.toRefs)(m),te=re.options,ce=re.show,Oe=re.container;(0,e.onMounted)(function(){ce&&Ce()}),(0,e.onBeforeUnmount)(function(){je()}),(0,e.watch)(ce,function(fe){fe?Ce():je()});var F={closeMenu:$e};function Ce(){We(),s(F)}function $e(fe){w.emit("update:show",!1),w.emit("close",fe),t(F)}function We(){setTimeout(function(){document.addEventListener("click",Ue,!0),document.addEventListener("contextmenu",Ue,!0),document.addEventListener("scroll",Ae,!0),!m.isFullScreenContainer&&Oe.value&&Oe.value.addEventListener("scroll",Ae,!0),te.value.keyboardControl!==!1&&document.addEventListener("keydown",ae)},50)}function je(){document.removeEventListener("contextmenu",Ue,!0),document.removeEventListener("click",Ue,!0),document.removeEventListener("scroll",Ae,!0),!m.isFullScreenContainer&&Oe.value&&Oe.value.removeEventListener("scroll",Ae,!0),te.value.keyboardControl!==!1&&document.removeEventListener("keydown",ae)}w.expose({closeMenu:$e});var ne=(0,e.ref)();function ae(fe){var Ve,et,tt,Re,Ge,Ke,Ye,Be,Fe=!0;switch(fe.key){case"Escape":var Te,Ze;((Te=ne.value)===null||Te===void 0?void 0:Te.isTopLevel())===!1?(Ze=ne.value)===null||Ze===void 0||Ze.closeCurrentSubMenu():$e();break;case"ArrowDown":(Ve=ne.value)===null||Ve===void 0||Ve.moveCurrentItemDown();break;case"ArrowUp":(et=ne.value)===null||et===void 0||et.moveCurrentItemUp();break;case"Home":(tt=ne.value)===null||tt===void 0||tt.moveCurrentItemFirst();break;case"End":(Re=ne.value)===null||Re===void 0||Re.moveCurrentItemLast();break;case"ArrowLeft":var W,ye,nt;(W=ne.value)!==null&&W!==void 0&&W.closeSelfAndActiveParent()||(ye=(nt=te.value).onKeyFocusMoveLeft)===null||ye===void 0||ye.call(nt);break;case"ArrowRight":(Ge=ne.value)!==null&&Ge!==void 0&&Ge.openCurrentItemSubMenu()||(Ke=(Ye=te.value).onKeyFocusMoveRight)===null||Ke===void 0||Ke.call(Ye);break;case"Enter":(Be=ne.value)===null||Be===void 0||Be.triggerCurrentItemClick(fe);break;default:Fe=!1;break}Fe&&ne.value&&(fe.stopPropagation(),fe.preventDefault())}function Ae(){te.value.closeWhenScroll!==!1&&$e()}function Ue(fe){dt(fe.target)}function dt(fe){for(;fe;){if(fe.classList&&fe.classList.contains("mx-menu-host"))return;fe=fe.parentNode}je(),$e()}return(0,e.provide)("globalSetCurrentSubMenu",function(fe){return ne.value=fe}),(0,e.provide)("globalOptions",te.value),(0,e.provide)("globalCloseMenu",$e),(0,e.provide)("globalTheme",((R=te.value)===null||R===void 0?void 0:R.theme)||"light"),(0,e.provide)("globalIsFullScreenContainer",m.isFullScreenContainer),(0,e.provide)("globalClickCloseClassName",(V=te.value)===null||V===void 0?void 0:V.clickCloseClassName),(0,e.provide)("globalIgnoreClickClassName",(pe=te.value)===null||pe===void 0?void 0:pe.ignoreClickClassName),(0,e.provide)("globalIconFontClass",((he=te.value)===null||he===void 0?void 0:he.iconFontClass)||"iconfont"),(0,e.provide)("globalHasSlot",function(fe){return w.slots[fe]!==void 0}),(0,e.provide)("globalRenderSlot",function(fe,Ve){return(0,e.renderSlot)(w.slots,fe,X({},Ve),function(){return[(0,e.h)("span","Render slot failed")]},!1)}),(0,e.provide)("menuContext",{zIndex:te.value.zIndex||d.defaultZindex,container:Oe.value,adjustPadding:{x:0,y:0},getParentAbsY:function(){return te.value.x},getParentAbsX:function(){return te.value.y},getParentX:function(){return 0},getParentY:function(){return 0},getParentWidth:function(){return 0},getParentHeight:function(){return 0},getPositon:function(){return[te.value.x,te.value.y]},closeOtherSubMenuWithTimeOut:function(){},checkCloseOtherSubMenuTimeOut:function(){return!1},addOpenedSubMenu:function(){},closeOtherSubMenu:function(){},getParentContext:function(){return null},getSubMenuInstanceContext:function(){return null},getElement:function(){return null},addChildMenuItem:function(){},removeChildMenuItem:function(){},markActiveMenuItem:function(){},markThisOpenedByKeyBoard:function(){},isOpenedByKeyBoardFlag:function(){return!1},isMenuItemDataCollectedFlag:function(){return!1}}),function(){var fe,Ve;return ce.value?[(0,e.h)("div",{class:"mx-menu-ghost-host"},[(0,e.h)(Nt,{class:"mx-menu-host",items:(fe=te.value)===null||fe===void 0?void 0:fe.items,adjustPosition:(Ve=te.value)===null||Ve===void 0?void 0:Ve.adjustPosition,maxWidth:te.value.maxWidth||d.defaultMaxWidth,minWidth:te.value.minWidth||d.defaultMinWidth,direction:te.value.direction||d.defaultDirection},{default:w.slots.default})])]:[]}}}),cn=un,ge=cn,ut=(0,e.defineComponent)({name:"ContextMenu",emits:["update:show","close"],props:{options:{type:Object,default:null},show:{type:Boolean,default:!1}},setup:function(m,w){var R=(0,e.toRefs)(m),V=R.options,pe=R.show;return w.expose({closeMenu:function(){return w.emit("update:show",!1)}}),function(){var he=I(V.value),re=he.isNew,te=he.container,ce=he.eleId,Oe=pe.value?[(0,e.h)(ge,{options:V,show:!0,container:te,isFullScreenContainer:!re,"onUpdate:show":function(F){return w.emit("update:show",F)},onClose:function(F){var Ce,$e;w.emit("update:show",!1),w.emit("close"),(Ce=($e=V.value).onClose)===null||Ce===void 0||Ce.call($e,F)}},w.slots)]:[];return[(0,e.h)(e.Teleport,{to:"#".concat(ce)},Oe)]}}}),Oo=ut,Pn=Oo;function dn(m){return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},dn(m)}const To=(0,e.defineComponent)({name:"ContextMenuGroup",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},clickHandler:{type:Function,default:null},label:{type:String,default:""},icon:{type:String,default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},adjustSubMenuPosition:{type:Boolean,default:void 0},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0}},setup:function(m,w){var R=(0,e.inject)("globalOptions"),V=(0,e.toRefs)(m),pe=V.adjustSubMenuPosition,he=V.maxWidth,re=V.minWidth,te=typeof pe.value<"u"?pe.value:R.adjustPosition;return function(){return(0,e.h)(Ct,X(X({},m),{},{showRightArrow:!0,maxWidth:void 0,minWidth:void 0,adjustSubMenuPosition:void 0,hasChildren:dn(w.slots.default)!==void 0}),w.slots.default?{submenu:function(){return(0,e.h)(Nt,{maxWidth:he.value,minWidth:re.value,adjustPosition:te},{default:w.slots.default})}}:void 0)}}}),Lo=To,zn=Lo;function $o(m,w,R,V){var pe=(0,e.h)(ge,{options:m,show:!0,container:w,isFullScreenContainer:!R,onClose:function(he){var re;(0,e.render)(null,w),(re=m.onClose)===null||re===void 0||re.call(m,he)}},V);return(0,e.render)(pe,w),pe.component}function Dn(m,w){var R=I(m),V=$o(m,R.container,R.isNew,w);return V.exposed}const fn={install:function(m){m.config.globalProperties.$contextmenu=Dn,m.component("ContextMenu",Pn),m.component("ContextMenuItem",Ct),m.component("ContextMenuGroup",zn),m.component("ContextMenuSperator",ue),m.component("ContextMenuSeparator",ue),m.component("ContextSubMenu",Nt)},showContextMenu:function(m,w){return Dn(m,w)},closeContextMenu:i,transformMenuPosition:v};var Ro={key:0,ref:"menuBarContent",class:"mx-menu-bar-content"},Bo={key:1,ref:"menuBarContent",class:"mx-menu-bar-content"},No=["onClick","onMouseenter"];function jo(m,w,R,V,pe,he){var re,te=(0,e.resolveComponent)("MenuBarIconMenu");return(0,e.openBlock)(),(0,e.createElementBlock)("div",{class:(0,e.normalizeClass)(["mx-menu-bar",(re=m.options.theme)!==null&&re!==void 0?re:"",m.options.mini?"mini":""]),onFocus:w[1]||(w[1]=function(){return m.onFocus&&m.onFocus.apply(m,arguments)}),onBlur:w[2]||(w[2]=function(){return m.onBlur&&m.onBlur.apply(m,arguments)})},[(0,e.renderSlot)(m.$slots,"prefix"),m.options.mini?((0,e.openBlock)(),(0,e.createElementBlock)("div",Ro,[(0,e.createElementVNode)("div",{class:"mx-menu-bar-item",onClick:w[0]||(w[0]=function(ce){return m.onItemClick(0,null)})},[(0,e.createVNode)(te)])],512)):((0,e.openBlock)(),(0,e.createElementBlock)("div",Bo,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(m.menuItems,function(ce,Oe){return(0,e.openBlock)(),(0,e.createElementBlock)("div",{key:Oe,class:(0,e.normalizeClass)(["mx-menu-bar-item",ce==m.menuActive?"active":""]),onClick:function(F){return m.onItemClick(Oe,ce)},onMouseenter:function(F){return m.onItemEnter(Oe,ce)}},(0,e.toDisplayString)(ce.label),43,No)}),128))],512)),(0,e.renderSlot)(m.$slots,"suffix")],34)}var Ao={class:"mx-menu-bar-icon-menu",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},Po=(0,e.createElementVNode)("path",{d:"M133.310936 296.552327l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949 0-19.781623-15.997312-35.950949-35.950949-35.950949L133.310936 224.650428c-19.781623 0-35.950949 16.169326-35.950949 35.950949C97.359987 280.383 113.529313 296.552327 133.310936 296.552327z"},null,-1),zo=(0,e.createElementVNode)("path",{d:"M890.51705 476.135058 133.310936 476.135058c-19.781623 0-35.950949 16.169326-35.950949 35.950949 0 19.781623 16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949C926.467999 492.304384 910.298673 476.135058 890.51705 476.135058z"},null,-1),Do=(0,e.createElementVNode)("path",{d:"M890.51705 727.447673 133.310936 727.447673c-19.781623 0-35.950949 15.997312-35.950949 35.950949s16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-15.997312 35.950949-35.950949S910.298673 727.447673 890.51705 727.447673z"},null,-1),Fo=[Po,zo,Do];function Uo(m,w){return(0,e.openBlock)(),(0,e.createElementBlock)("svg",Ao,Fo)}const Vo={},Ho=(0,K.Z)(Vo,[["render",Uo]]),Wo=Ho,Go=(0,e.defineComponent)({name:"MenuBar",emits:[],props:{options:{type:Object,default:null}},components:{MenuBarIconMenu:Wo},setup:function(m){var w=(0,e.ref)(),R=(0,e.ref)(!1),V=(0,e.ref)([]),pe=(0,e.ref)(null);function he(){R.value=!0}function re(){R.value=!1}(0,e.onMounted)(function(){V.value=m.options.items||[]}),(0,e.watch)(function(){return m.options},function(){V.value=m.options.items||[]});var te=null,ce=-1;function Oe(){ce<V.value.length-1?ce++:ce=0,Ce(ce,V.value[ce])}function F(){ce>0?ce--:ce=V.value.length-1,Ce(ce,V.value[ce])}function Ce(ne,ae){var Ae;if(ce=ne,ae.children){te&&(te.closeMenu(),te=null,R.value=!0),pe.value=ae;var Ue=(Ae=w.value)===null||Ae===void 0?void 0:Ae.children[ne];Ue&&(te=fn.showContextMenu(X(X({},m.options),{},{items:ae.children,x:f(Ue),y:c(Ue)+Ue.offsetHeight,onKeyFocusMoveLeft:function(){F()},onKeyFocusMoveRight:function(){Oe()},onClose:function(){pe.value==ae&&(R.value=!1,pe.value=null)}})))}}function $e(){ce=0;var ne=w.value;ne&&(te=fn.showContextMenu(X(X({},m.options),{},{x:f(ne),y:c(ne)+ne.offsetHeight})))}function We(ne,ae){ae?(R.value=!0,Ce(ne,ae),ae.onClick&&(ae.clickableWhenHasChildren===!0&&ae.children&&ae.children.length>0||!ae.children||ae.children.length===0)&&ae.onClick()):$e()}function je(ne,ae){R.value&&Ce(ne,ae)}return{menuItems:V,menuActive:pe,menuBarContent:w,menuBarActive:R,onFocus:he,onBlur:re,onItemClick:We,onItemEnter:je}}}),Ko=(0,K.Z)(Go,[["render",jo]]),qo=Ko,Xo=fn,Yo=Xo})(),b})())})(ko);var ze=ko.exports;const Zs=L("span",{class:"icon"},"@",-1),Js=me({__name:"index",props:{uid:{},options:{}},setup(a){var i;const r=a,u=ho(r.uid),p=(i=_t())==null?void 0:i.userInfo,g=it(),h=Ft(),b=q(()=>h.countInfo),o=q(()=>(p==null?void 0:p.uid)===u.value),l=q(()=>(p==null?void 0:p.power)===lo.ADMIN),e=(d,c)=>rt.emit("onSelectPerson",{uid:d,ignoreCheck:c}),n=async()=>{const d=r.uid;d&&await at.blockUser({uid:d}).send()},s=async()=>{g.addFriendModalInfo.show=!0,g.addFriendModalInfo.uid=r.uid},t=async()=>{await at.removeGroupMember({uid:r.uid,roomId:g.currentSession.roomId}).send(),h.getGroupUserList(!0)};return(d,c)=>{const f=De("Icon"),v=pt("login-show"),y=pt("friends");return E(),ie(x(ze.ContextMenu),{options:{theme:"dark",x:0,y:0,...r.options}},{default:B(()=>[be((E(),ie(x(ze.ContextMenuItem),{label:"艾特Ta",onClick:c[0]||(c[0]=C=>e==null?void 0:e(r.uid,!0))},{icon:B(()=>[Zs]),_:1})),[[v]]),l.value?(E(),ie(x(ze.ContextMenuItem),{key:0,label:"拉黑(管理)",onClick:n},{icon:B(()=>[O(f,{icon:"lahei",size:13})]),_:1})):Q("",!0),be((E(),ie(x(ze.ContextMenuItem),{vLoginShow:"",label:"添加好友",onClick:s},{icon:B(()=>[O(f,{icon:"tianjia",size:13})]),_:1})),[[y,u.value]]),[x(Et).LORD,x(Et).ADMIN].includes(b.value.role)&&!o.value?(E(),ie(x(ze.ContextMenuItem),{key:1,vLoginShow:"",label:"剔出群聊",onClick:t},{icon:B(()=>[O(f,{icon:"yichu",size:13})]),_:1})):Q("",!0)]),_:1},8,["options"])}}});const Qs={[Et.LORD]:{text:"群主",class:"lord"},[Et.ADMIN]:{text:"管理员",class:"admin"}},ea={class:"user-name"},ta={class:"text"},na=me({__name:"index",props:{user:{}},setup(a){var l;const r=a,u=ho(r.user),p=tn((l=u.value)==null?void 0:l.uid),g=A(!1),h=A({x:0,y:0}),b=e=>{if(!_t().isSign)return;const{x:n,y:s}=e;h.value.x=n,h.value.y=s,g.value=!0},o=q(()=>r.user.roleId?Qs[r.user.roleId]:"");return(e,n)=>{var t;const s=De("Avatar");return E(),j("li",{class:"user-list-item",tabindex:"0",key:e.user.uid,onContextmenu:n[1]||(n[1]=St(i=>b(i),["prevent","stop"]))},[O(s,{src:x(p).avatar,size:24,showStatus:"",online:e.user.activeStatus===x(fr).ONLINE},null,8,["src","online"]),L("div",ea,[L("div",ta,de(x(p).name),1),o.value?(E(),j("div",{key:0,class:ve(["badge flex-center",o.value.class])},de(o.value.text),3)):Q("",!0)]),O(Js,{show:g.value,"onUpdate:show":n[0]||(n[0]=i=>g.value=i),options:h.value,uid:(t=e.user)==null?void 0:t.uid},null,8,["show","options","uid"])],32)}}});const oa=lt(na,[["__scopeId","data-v-77f6665a"]]),ra={class:"user-list-box"},sa={class:"user-list-header"},aa={key:0,class:"list-no-data"},ia=me({__name:"index",setup(a){const r=A(),u=Ft(),p=it(),g=$n(),h=q(()=>u.userList),b=q(()=>u.countInfo);mt(()=>{let e;$t(()=>{e=new IntersectionObserver(async n=>{var s;(s=n==null?void 0:n[0])!=null&&s.isIntersecting&&(await u.loadMore(),r.value&&e.unobserve(r.value),setTimeout(()=>{r.value&&e.observe(r.value)},500))}),r.value&&e.observe(r.value)}),jn(()=>{r.value&&e.unobserve(r.value)})});const o=()=>u.showGroupList=!1,l=()=>{p.createGroupModalInfo.show=!0,p.createGroupModalInfo.isInvite=!0,p.createGroupModalInfo.selectedUid=g.currentAtUsersList.map(e=>e.uid)};return(e,n)=>{var d,c;const s=Ot,t=pt("login-show"),i=$s;return E(),j("div",ra,[L("div",{class:ve(["user-list-mask",x(u).showGroupList?"show":""]),onClick:o},null,2),L("div",{class:ve(["user-list-wrapper",x(u).showGroupList?"show":""])},[L("div",sa,[Ne(" 在线人数："+de(b.value.onlineNum||0)+" ",1),be(O(s,{type:"primary",icon:x(pr),circle:"",disabled:b.value.role===x(Et).REMOVED,size:"small",onClick:l},null,8,["icon","disabled"]),[[t]])]),be((E(),ie($r,{tag:"ul",name:"fade",class:"user-list"},{default:B(()=>[(E(!0),j(ft,null,Tt(h.value,f=>(E(),ie(oa,{key:f.uid,user:f},null,8,["user"]))),128)),L("li",{key:"visible_el",ref_key:"groupListLastElRef",ref:r}," ",512)]),_:1})),[[He,(d=h.value)==null?void 0:d.length],[i,x(u).userListOptions.loading,void 0,{lock:!0}]]),((c=h.value)==null?void 0:c.length)===0?(E(),j("div",aa,"暂无成员~")):Q("",!0)],2)])}}});const la=lt(ia,[["__scopeId","data-v-8c8a5901"]]),ua={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ca=L("path",{fill:"currentColor",d:"M104.704 338.752a64 64 0 0 1 90.496 0l316.8 316.8l316.8-316.8a64 64 0 0 1 90.496 90.496L557.248 791.296a64 64 0 0 1-90.496 0L104.704 429.248a64 64 0 0 1 0-90.496z"},null,-1),da=[ca];function fa(a,r){return E(),j("svg",ua,da)}const pa={name:"ep-arrow-down-bold",render:fa},ma={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},va=L("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),ga=[va];function ha(a,r){return E(),j("svg",ma,ga)}const ya={name:"ep-loading",render:ha};var ba=mr,_a=function(){return ba.Date.now()},Ca=_a,ka=/\s/;function Sa(a){for(var r=a.length;r--&&ka.test(a.charAt(r)););return r}var xa=Sa,wa=xa,Ia=/^\s+/;function Ma(a){return a&&a.slice(0,wa(a)+1).replace(Ia,"")}var Ea=Ma,Oa=vr,Ta=gr,La="[object Symbol]";function $a(a){return typeof a=="symbol"||Ta(a)&&Oa(a)==La}var Ra=$a,Ba=Ea,to=Rn,Na=Ra,no=0/0,ja=/^[-+]0x[0-9a-f]+$/i,Aa=/^0b[01]+$/i,Pa=/^0o[0-7]+$/i,za=parseInt;function Da(a){if(typeof a=="number")return a;if(Na(a))return no;if(to(a)){var r=typeof a.valueOf=="function"?a.valueOf():a;a=to(r)?r+"":r}if(typeof a!="string")return a===0?a:+a;a=Ba(a);var u=Aa.test(a);return u||Pa.test(a)?za(a.slice(2),u?2:8):ja.test(a)?no:+a}var Fa=Da,Ua=Rn,wn=Ca,oo=Fa,Va="Expected a function",Ha=Math.max,Wa=Math.min;function Ga(a,r,u){var p,g,h,b,o,l,e=0,n=!1,s=!1,t=!0;if(typeof a!="function")throw new TypeError(Va);r=oo(r)||0,Ua(u)&&(n=!!u.leading,s="maxWait"in u,h=s?Ha(oo(u.maxWait)||0,r):h,t="trailing"in u?!!u.trailing:t);function i(_){var M=p,$=g;return p=g=void 0,e=_,b=a.apply($,M),b}function d(_){return e=_,o=setTimeout(v,r),n?i(_):b}function c(_){var M=_-l,$=_-e,z=r-M;return s?Wa(z,h-$):z}function f(_){var M=_-l,$=_-e;return l===void 0||M>=r||M<0||s&&$>=h}function v(){var _=wn();if(f(_))return y(_);o=setTimeout(v,c(_))}function y(_){return o=void 0,t&&p?i(_):(p=g=void 0,b)}function C(){o!==void 0&&clearTimeout(o),e=0,p=l=g=o=void 0}function k(){return o===void 0?b:y(wn())}function I(){var _=wn(),M=f(_);if(p=arguments,g=this,l=_,M){if(o===void 0)return d(l);if(s)return clearTimeout(o),o=setTimeout(v,r),i(l)}return o===void 0&&(o=setTimeout(v,r)),b}return I.cancel=C,I.flush=k,I}var Ka=Ga,qa=Ka,Xa=Rn,Ya="Expected a function";function Za(a,r,u){var p=!0,g=!0;if(typeof a!="function")throw new TypeError(Ya);return Xa(u)&&(p="leading"in u?!!u.leading:p,g="trailing"in u?!!u.trailing:g),qa(a,r,{leading:p,maxWait:r,trailing:g})}var Ja=Za;const So=Fr(Ja);class Qa{constructor(r,u){Sn(this,"sizes",new Map);Sn(this,"offset");this.init(r,u)}init(r,u){this.param=r,this.callUpdate=u,this.sizes=new Map,this.firstRangeTotalSize=0,this.firstRangeAverageSize=0,this.lastCalcIndex=0,this.fixedSizeValue=0,this.calcType="INIT",this.offset=0,this.direction="",this.range=Object.create(null),r&&this.checkRange(0,r.keeps-1)}destroy(){this.init(null,null)}getRange(){const r=Object.create(null);return r.start=this.range.start,r.end=this.range.end,r.padFront=this.range.padFront,r.padBehind=this.range.padBehind,r}isBehind(){return this.direction==="BEHIND"}isFront(){return this.direction==="FRONT"}getOffset(r){return(r<1?0:this.getIndexOffset(r))+this.param.slotHeaderSize}updateParam(r,u){this.param&&r in this.param&&(r==="uniqueIds"&&this.sizes.forEach((p,g)=>{u.includes(g)||this.sizes.delete(g)}),this.param[r]=u)}saveSize(r,u){this.sizes.set(r,u),this.calcType==="INIT"?(this.fixedSizeValue=u,this.calcType="FIXED"):this.calcType==="FIXED"&&this.fixedSizeValue!==u&&(this.calcType="DYNAMIC",delete this.fixedSizeValue),this.calcType!=="FIXED"&&typeof this.firstRangeTotalSize<"u"&&(this.sizes.size<Math.min(this.param.keeps,this.param.uniqueIds.length)?(this.firstRangeTotalSize=[...this.sizes.values()].reduce((p,g)=>p+g,0),this.firstRangeAverageSize=Math.round(this.firstRangeTotalSize/this.sizes.size)):delete this.firstRangeTotalSize)}handleDataSourcesChange(){let r=this.range.start;this.isFront()?r=r-2:this.isBehind()&&(r=r+2),r=Math.max(r,0),this.updateRange(this.range.start,this.getEndByStart(r))}handleSlotSizeChange(){this.handleDataSourcesChange()}handleScroll(r){this.direction=r<this.offset?"FRONT":"BEHIND",this.offset=r,this.param&&(this.direction==="FRONT"?this.handleFront():this.direction==="BEHIND"&&this.handleBehind())}handleFront(){const r=this.getScrollOvers();if(r>this.range.start)return;const u=Math.max(r-this.param.buffer,0);this.checkRange(u,this.getEndByStart(u))}handleBehind(){const r=this.getScrollOvers();r<this.range.start+this.param.buffer||this.checkRange(r,this.getEndByStart(r))}getScrollOvers(){const r=this.offset-this.param.slotHeaderSize;if(r<=0)return 0;if(this.isFixedType())return Math.floor(r/this.fixedSizeValue);let u=0,p=0,g=0,h=this.param.uniqueIds.length;for(;u<=h;){if(p=u+Math.floor((h-u)/2),g=this.getIndexOffset(p),g===r)return p;g<r?u=p+1:g>r&&(h=p-1)}return u>0?--u:0}getIndexOffset(r){if(!r)return 0;let u=0,p=0;for(let g=0;g<r;g++)p=this.sizes.get(this.param.uniqueIds[g]),u=u+(typeof p=="number"?p:this.getEstimateSize());return this.lastCalcIndex=Math.max(this.lastCalcIndex,r-1),this.lastCalcIndex=Math.min(this.lastCalcIndex,this.getLastIndex()),u}isFixedType(){return this.calcType==="FIXED"}getLastIndex(){return this.param.uniqueIds.length-1}checkRange(r,u){const p=this.param.keeps;this.param.uniqueIds.length<=p?(r=0,u=this.getLastIndex()):u-r<p-1&&(r=u-p+1),this.range.start!==r&&this.updateRange(r,u)}updateRange(r,u){this.range.start=r,this.range.end=u,this.range.padFront=this.getPadFront(),this.range.padBehind=this.getPadBehind(),this.callUpdate(this.getRange())}getEndByStart(r){const u=r+this.param.keeps-1;return Math.min(u,this.getLastIndex())}getPadFront(){return this.isFixedType()?this.fixedSizeValue*this.range.start:this.getIndexOffset(this.range.start)}getPadBehind(){const r=this.range.end,u=this.getLastIndex();return this.isFixedType()?(u-r)*this.fixedSizeValue:this.lastCalcIndex===u?this.getIndexOffset(u)-this.getIndexOffset(r):(u-r)*this.getEstimateSize()}getEstimateSize(){return this.isFixedType()?this.fixedSizeValue:this.firstRangeAverageSize||this.param.estimateSize}}const ei=me({name:"VirtualListItem",props:{index:{type:Number},source:{type:Object},component:{type:[Object,Function]},uniqueKey:{type:[String,Number]},itemProps:{type:Object,default:()=>{}},dataPropName:{type:String,default:"source"}},emits:["itemResize"],setup(a,{emit:r}){const u=A(null);let p=null;const g=()=>{const{uniqueKey:h}=a,b=u.value?u.value.offsetHeight:0;r("itemResize",h,b)};return mt(()=>{typeof ResizeObserver<"u"&&(p=new ResizeObserver(()=>{g()}),u.value&&p.observe(u.value))}),Rr(()=>{g()}),jn(()=>{p&&(p.disconnect(),p=null)}),()=>{const{component:h,index:b,source:o,uniqueKey:l,itemProps:e,dataPropName:n}=a,s={...e,index:b,[n]:o};return O("div",Ut({key:l,ref:u},{index:b}),[O(h,s,null)])}}}),xo=me({name:"VirtualList",props:{data:{type:Array,required:!0,default:()=>[]},dataKey:{type:[String,Function],required:!0},item:{type:[Object,Function],required:!0},keeps:{type:Number,default:30},size:{type:Number,default:50},start:{type:Number,default:0},offset:{type:Number,default:0},topThreshold:{type:Number,default:0},bottomThreshold:{type:Number,default:0},itemProps:{type:Object},dataPropName:{type:String,default:"source"}},setup(a,{emit:r,expose:u}){const p=A(null),g=A(),h=A(null);let b;ot(()=>a.data.length,()=>{b.updateParam("uniqueIds",i()),b.handleDataSourcesChange()}),ot(()=>a.keeps,_=>{b.updateParam("keeps",_),b.handleSlotSizeChange()}),ot(()=>a.start,_=>{f(_)}),ot(()=>a.offset,_=>v(_));const o=_=>b.sizes.get(_),l=()=>g.value?Math.ceil(g.value.scrollTop):0,e=()=>{const _="clientHeight";return g.value?Math.ceil(g.value[_]):0},n=()=>{const _="scrollHeight";return g.value?Math.ceil(g.value[_]):0},s=(_,M,$)=>{r("scroll",{offset:_,clientSize:M,scrollSize:$}),b.isFront()&&a.data.length&&_-a.topThreshold<=0?r("totop"):b.isBehind()&&_+M+a.bottomThreshold>=$&&r("tobottom")},t=()=>{const _=l(),M=e(),$=n();_<0||_+M>$+1||!$||(b.handleScroll(_),s(_,M,$))},i=()=>{const{dataKey:_,data:M=[]}=a;return M.map($=>typeof _=="function"?_($):$[_])},d=_=>{p.value=_},c=()=>{b=new Qa({slotHeaderSize:0,slotFooterSize:0,keeps:a.keeps,estimateSize:a.size,buffer:Math.round(a.keeps/3),uniqueIds:i()},d),p.value=b.getRange()},f=(_,M,$=0)=>{if(_>=a.data.length-1)k();else{const z=b.getOffset(_)-$;v(z,M)}},v=(_,M=!1)=>{g.value&&g.value.scroll({left:0,top:_,behavior:M?"smooth":"auto"})},y=()=>{const _=[],{start:M,end:$}=p.value,{data:z,dataKey:X,item:U,itemProps:J,dataPropName:H}=a;for(let ee=M;ee<=$;ee++){const le=z[ee];if(le){const T=typeof X=="function"?X(le):le[X];(typeof T=="string"||typeof T=="number")&&_.push(O(ei,{index:ee,uniqueKey:T,source:le,component:U,itemProps:J,dataPropName:H,onItemResize:C},null))}}return _},C=(_,M)=>{b.saveSize(_,M),r("resized",_,M)},k=_=>{if(h.value){const M=h.value.offsetTop;v(M,_),setTimeout(()=>{l()+e()<n()&&k(_)},3)}},I=()=>b.sizes.size;return go(()=>{c()}),Br(()=>{v(b.offset)}),mt(()=>{a.start?f(a.start):a.offset&&v(a.offset),r("ok")}),jn(()=>{b.destroy()}),u({scrollToBottom:k,getSizes:I,getSize:o,getOffset:l,getScrollSize:n,getClientSize:e,scrollToOffset:v,scrollToIndex:f}),()=>{const{padFront:_,padBehind:M}=p.value;return O("div",{ref:g,onScroll:t},[O("div",{style:{padding:`${_}px 0px ${M}px`}},[y()]),O("div",{ref:h,style:{width:"100%",height:"0px"}},null)])}}}),ti={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ni=L("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),oi=[ni];function ri(a,r){return E(),j("svg",ti,oi)}const si={name:"ep-check",render:ri};const wo=a=>{const r=q(()=>a.messageMark.userLike===gt.YES),u=q(()=>a.messageMark.userDislike===gt.YES),p=q(()=>a.messageMark.likeCount),g=q(()=>a.messageMark.dislikeCount);return{isLike:r,isDisLike:u,likeCount:p,dislikeCount:g,onLike:async()=>{const o=r.value?It.Cancel:It.Confirm;await at.markMsg({actType:o,markType:qn.LIKE,msgId:a.id}).send();const{likeCount:l}=a.messageMark,e=o===It.Confirm;a.messageMark.userLike=e?gt.YES:gt.NO,a.messageMark.likeCount=e?l+1:l-1,u.value&&(a.messageMark.userDislike=gt.NO,a.messageMark.dislikeCount=g.value-1)},onDisLike:async()=>{const o=u.value?It.Cancel:It.Confirm;await at.markMsg({actType:o,markType:qn.DISLIKE,msgId:a.id}).send();const{dislikeCount:l}=a.messageMark,e=o===It.Confirm;a.messageMark.userDislike=e?gt.YES:gt.NO,a.messageMark.dislikeCount=e?l+1:l-1,r.value&&(a.messageMark.userLike=gt.NO,a.messageMark.likeCount=p.value-1)}}},ai={key:0,class:"msg-option"},ii={class:"msg-option-item",title:"回复"},li={class:"msg-option-item",title:"点赞"},ui={class:"msg-option-item",title:"不喜欢"},ci=me({__name:"index",props:{msg:{}},setup(a){const r=a,u=bt(),{isLike:p,isDisLike:g,onLike:h,onDisLike:b}=wo(r.msg.message),o=async l=>{l&&(u.currentMsgReply=l,rt.emit("focusMsgInput"))};return(l,e)=>{const n=De("Icon"),s=pt("login");return l.msg.loading?Q("",!0):(E(),j("div",ai,[L("span",ii,[be(O(n,{icon:"reply",size:14},null,512),[[s,()=>o(l.msg)]])]),L("span",li,[be(O(n,{icon:"like",size:14,class:ve([{"like-active":x(p)}])},null,8,["class"]),[[s,()=>x(h)()]])]),L("span",ui,[be(O(n,{icon:"dislike",size:15,class:ve([{"dislike-active":x(g)}])},null,8,["class"]),[[s,()=>x(b)()]])])]))}}});const di=lt(ci,[["__scopeId","data-v-80260998"]]),fi=a=>new Promise((r,u)=>{try{const p=document.createElement("textarea");p.setAttribute("readonly","readonly"),p.value=a,p.style.zIndex="-1",document.body.appendChild(p),p.select(),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(p),r(a)}catch(p){u(p)}}),pi=a=>{const r=document.createElement("canvas"),u=r.getContext("2d"),p=new Image;p.crossOrigin="Anonymous",p.src=a,p.onload=()=>{u&&(r.width=p.width,r.height=p.height,u.clearRect(0,0,u.canvas.width,u.canvas.height),u.drawImage(p,0,0),r.toBlob(async g=>{if(!g)return;const h=[new ClipboardItem({[g.type]:g})];try{await navigator.clipboard.write(h)}catch{}finally{r.remove()}}))}},Io=()=>{const a=A(!1),r=A(0),u=Bn(),p=Mt(),g=Mt(),h=Mt(),b=async(e,n)=>(a.value=!0,new Promise((s,t)=>{const i=new XMLHttpRequest;i.open("PUT",e,!0),i.setRequestHeader("Content-Type",n.type),i.upload.onprogress=d=>{r.value=Math.round(d.loaded/d.total*100)},i.onload=()=>{a.value=!1,i.status===200?(g.trigger(n),s(!0)):(h.trigger(n),t(!1))},i.onerror=()=>{h.trigger(n),t(!1)},i.send(n)})),o=async e=>new Promise(t=>{if(e.type==="image/gif"){t(e);return}const i=new Image,d=URL.createObjectURL(e);i.src=d,i.onload=()=>{const{height:c,width:f}=i;let v,y;f>c?(v=240,y=Math.round(c/f*240)):(y=240,v=Math.round(f/c*240));const C=document.createElement("canvas"),k=C.getContext("2d");C.height=240,C.width=240,k&&(k.clearRect(0,0,240,240),k.fillStyle="rgba(0, 0, 0, 0)",k.fillRect(0,0,240,240),k.drawImage(i,0,0,f,c,(240-v)/2,(240-y)/2,v,y),C.toBlob(I=>{if(!I)return;const _=Date.now()+"_emoji.png",M=new File([I],_,{type:"image/png"});t(M),URL.revokeObjectURL(d)},"image/png",.9))},i.onerror=()=>{URL.revokeObjectURL(d)}}),l=async e=>{const n=await o(e);if(!n)return;const{downloadUrl:s,uploadUrl:t}=await at.getUploadUrl({fileName:n.name,scene:"2"}).send();t&&s&&(p.trigger({file:e,downloadUrl:s}),b(t,n).then(i=>{i&&u.addEmoji(s)}))};return{isEmojiUp:a,onStart:p.on,onFail:h.on,onSuccess:g.on,uploadEmoji:l}},ro=(a,r,u)=>{const{size:p,width:g,height:h,downloadUrl:b,name:o,second:l,tempUrl:e,thumbWidth:n,thumbHeight:s,thumbUrl:t,thumbSize:i}=a,c={size:p,url:u?e:b};let f={};return r===se.IMAGE?f={...c,width:g,height:h}:r===se.VOICE?f={...c,second:l}:r===se.VIDEO?f={...c,thumbWidth:n,thumbHeight:s,thumbUrl:t,thumbSize:i}:r===se.FILE&&(f={...c,fileName:o,url:b}),{body:f,type:r}},mi=async a=>await(await fetch(a)).blob(),vi=async(a,r)=>{const u=await mi(a),p=u.type,g=r||Date.now()+"_emoji.png";return new File([u],g,{type:p})},gi=me({__name:"index",props:{msg:{},options:{}},setup(a){var d;const r=a,u=Bn(),{uploadEmoji:p}=Io(),g=(d=_t())==null?void 0:d.userInfo,h=bt(),b=q(()=>{var c;return((c=r.msg)==null?void 0:c.fromUser.uid)===g.uid}),o=q(()=>(g==null?void 0:g.power)===lo.ADMIN),l=async()=>{const{id:c}=r.msg.message;c&&(await at.recallMsg({roomId:1,msgId:c}).send(),h.updateRecallStatus({msgId:c}))},e=async()=>{const{uid:c}=r.msg.fromUser;c&&await at.blockUser({uid:c}).send()},n=()=>{var f;const c=r.msg.message;if(c.type===se.TEXT){const v=(f=c.body)==null?void 0:f.content;fi(v),st.success("复制成功~")}c.type===se.IMAGE&&(pi(c.body.url),st.success("复制成功~"))},s=()=>{const{body:c}=r.msg.message,f=c==null?void 0:c.url;if(!f)return;const v=new XMLHttpRequest;v.open("GET",f,!0),v.responseType="blob",v.onreadystatechange=()=>{if(v.status!=200)return st.error("下载失败~");if(v.readyState===4&&v.status===200){const y=v.response;let C=document.createElement("a");C.href=URL.createObjectURL(y),C.download=c.fileName||"未知文件",C.dispatchEvent(new MouseEvent("click")),C.remove()}},v.send()},t=()=>{const{type:c,body:f}=r.msg.message;c===se.EMOJI?u.addEmoji(f.url):vi(f.url).then(v=>{p(v)})},i=()=>h.deleteMsg(r.msg.message.id);return(c,f)=>{const v=De("Icon"),y=pt("login-show");return E(),ie(x(ze.ContextMenu),{options:{theme:"dark",x:0,y:0,...r.options}},{default:B(()=>[c.msg.message.type===x(se).TEXT||c.msg.message.type===x(se).IMAGE?(E(),ie(x(ze.ContextMenuItem),{key:0,label:"复制",onClick:n},{icon:B(()=>[O(v,{icon:"copy",size:13})]),_:1})):Q("",!0),(c.msg.message.type===x(se).EMOJI||c.msg.message.type===x(se).IMAGE)&&!b.value&&x(u).emojiList.length<50?(E(),ie(x(ze.ContextMenuItem),{key:1,label:"添加到表情",onClick:t},{icon:B(()=>[O(v,{icon:"aixin",size:13})]),_:1})):Q("",!0),(b.value||o.value)&&!c.msg.loading?(E(),ie(x(ze.ContextMenuItem),{key:2,label:"撤回消息",onClick:l},{icon:B(()=>[O(v,{icon:"chehui",size:14})]),_:1})):Q("",!0),(c.msg.message.type===x(se).FILE||c.msg.message.type===x(se).IMAGE)&&!c.msg.loading?(E(),ie(x(ze.ContextMenuItem),{key:3,label:"下载",onClick:s},{icon:B(()=>[O(v,{icon:"xiazai",size:15})]),_:1})):Q("",!0),be(O(x(ze.ContextMenuSeparator),null,null,512),[[y]]),be((E(),ie(x(ze.ContextMenuItem),{label:"删除",onClick:i},{icon:B(()=>[O(v,{icon:"shanchu",size:13})]),_:1})),[[y]]),o.value?(E(),ie(x(ze.ContextMenuItem),{key:4,label:"拉黑(管理)",onClick:e},{icon:B(()=>[O(v,{icon:"lahei",size:13})]),_:1})):Q("",!0)]),_:1},8,["options"])}}});const hi=L("span",{class:"icon"},"@",-1),yi=me({__name:"index",props:{uid:{},options:{}},setup(a){const r=a,u=it(),p=async()=>{u.addFriendModalInfo.show=!0,u.addFriendModalInfo.uid=r.uid},g=(h,b)=>rt.emit("onSelectPerson",{uid:h,ignoreCheck:b});return(h,b)=>{const o=De("Icon"),l=pt("login-show"),e=pt("friends");return E(),ie(x(ze.ContextMenu),{options:{theme:"dark",x:0,y:0,...r.options}},{default:B(()=>[be((E(),ie(x(ze.ContextMenuItem),{label:"艾特Ta",onClick:b[0]||(b[0]=n=>g==null?void 0:g(r.uid,!0))},{icon:B(()=>[hi]),_:1})),[[l]]),be((E(),ie(x(ze.ContextMenuItem),{vLoginShow:"",label:"添加好友",onClick:p},{icon:B(()=>[O(o,{icon:"tianjia",size:13})]),_:1})),[[e,h.uid]])]),_:1},8,["options"])}}});const bi=a=>(rn("data-v-51366e5c"),a=a(),sn(),a),_i={class:"user-card_top"},Ci={class:"user-card_top-avatar"},ki={class:"user-card_top-info"},Si={class:"user-card_top-info_name"},xi={class:"user-card_top-info_id"},wi={class:"user-card_top-info_place"},Ii={key:0,class:"user-card_badge"},Mi=["src","alt","title"],Ei=["src","alt","title"],Oi={class:"user-card_other"},Ti=bi(()=>L("span",null,"发消息",-1)),Li=me({__name:"UserCard",props:{user:{}},setup(a){const r=a,u=bt(),p=it(),g=$n(),h=_t(),b=A(),o=async()=>{const l=await at.sessionDetailWithFriends({uid:r.user.uid}).send();p.currentSession.roomId=l.roomId,p.currentSession.type=uo.Single,u.updateSessionLastActiveTime(l.roomId,l)};return mt(()=>{g.getBatchBadgeInfo(r.user.itemIds)}),(l,e)=>{var d;const n=An,s=nn,t=Ln,i=De("Icon");return E(),j("div",{ref_key:"userCard",ref:b,class:"user-card"},[L("div",_i,[L("div",Ci,[O(n,{shape:"square",size:55,src:l.user.avatar},null,8,["src"])]),L("div",ki,[O(s,{effect:"dark",content:l.user.name,placement:"top-start"},{default:B(()=>[L("div",Si,"昵称："+de(l.user.name),1)]),_:1},8,["content"]),L("div",xi,"uid："+de(l.user.uid),1),L("div",wi,"地区："+de(l.user.locPlace),1)])]),(d=l.user.itemIds)!=null&&d.length?(E(),j("div",Ii,[(E(!0),j(ft,null,Tt(l.user.itemIds,c=>{var f,v,y;return E(),j("div",{class:"user-card_badge-item",key:c},[l.user.wearingItemId===c?(E(),ie(t,{key:0,"is-dot":""},{default:B(()=>{var C,k,I;return[L("img",{class:"user-card_badge-item",src:(C=x(g).badgeCachedList[c])==null?void 0:C.img,alt:(k=x(g).badgeCachedList[c])==null?void 0:k.describe,title:(I=x(g).badgeCachedList[c])==null?void 0:I.describe},null,8,Mi)]}),_:2},1024)):(E(),j("img",{key:1,class:"user-card_badge-item",src:(f=x(g).badgeCachedList[c])==null?void 0:f.img,alt:(v=x(g).badgeCachedList[c])==null?void 0:v.describe,title:(y=x(g).badgeCachedList[c])==null?void 0:y.describe},null,8,Ei))])}),128))])):Q("",!0),L("div",Oi,[x(h).isSign?(E(),j("div",{key:0,class:"user-card_other-item user-card_other_send",onClick:o},[O(i,{class:"tool-icon",icon:"chat",size:28}),Ti])):Q("",!0)])],512)}}});const $i=lt(Li,[["__scopeId","data-v-51366e5c"]]),Ri={key:0,class:"send-time-block"},Bi={key:1,class:"send-time-block"},Ni={class:"chat-item-user-info"},ji=["src"],Ai={class:"user-ip"},Pi={key:0,class:"send-time"},zi={key:0,class:"chat-item-read-count-text"},Di={class:"ellipsis"},Fi={key:1,class:"extra"},Ui=me({inheritAttrs:!1,__name:"index",props:{msg:{},isShowTime:{type:Boolean,default:!0},isShowTimeBlock:{type:Boolean,default:!0},bubbleMode:{default:"spread"},tooltipTrigger:{default:()=>"hover"}},setup(a){const r=a,u=q(()=>r.msg.message),p=q(()=>r.msg.fromUser),g=_t(),h=bt(),b=it(),o=tn(p.value.uid),l=q(()=>{var T;return(T=o==null?void 0:o.value)==null?void 0:T.wearingItemId}),e=Cr(l),n=q(()=>p.value.uid===(g==null?void 0:g.userInfo.uid)),s=q(()=>({"chat-item":!0,"is-me":n.value,right:n.value&&r.bubbleMode==="spread"||r.bubbleMode==="right"})),t=A(null),i=A(null),d=A(),c=on({read:0,unread:null}),f=Zt("virtualListRef"),v=A(!1),y=A(!1),C=A({x:0,y:0}),{isLike:k,isDisLike:I,likeCount:_,dislikeCount:M,onLike:$,onDisLike:z}=wo(r.msg.message),X=q(()=>[se.RECALL,se.SYSTEM].includes(u.value.type)),U=async T=>{var S,P;const{id:D}=T,{reply:oe}=T.body;if(!oe||!oe.canCallback)return;const _e=h.getMsgIndex(oe.id);if(_e>-1)(S=f==null?void 0:f.value)==null||S.scrollToIndex(_e,!0,12);else{const Y=h.getMsgIndex(D),G=Math.ceil((oe.gapCount-Y+1)/Xn)*Xn;await h.loadMore(G),setTimeout((P=f==null?void 0:f.value)==null?void 0:P.scrollToIndex(h.getMsgIndex(oe.id),!1,12),0)}},J=T=>{if(!g.isSign)return;const{x:D,y:oe}=T;C.value.x=D,C.value.y=oe,v.value=!0},H=T=>{if(!g.isSign||n.value)return;const{x:D,y:oe}=T;C.value.x=D,C.value.y=oe,y.value=!0},ee=A(null);mt(()=>{$t(()=>{if(t.value&&i.value){const oe=t.value.clientWidth,_e=i.value.clientWidth;oe+150<=_e?d.value="right-start":r.msg.message.body.reply?d.value="top-end":d.value="bottom-end"}const T=Nr(ee),D=r.msg.message;n.value&&ee&&![se.RECALL,se.SYSTEM].includes(D.type)&&ot(T,oe=>{oe?rt.emit("onAddReadCountTask",{msgId:r.msg.message.id}):rt.emit("onRemoveReadCountTask",{msgId:r.msg.message.id})})}),rt.on("onGetReadCount",T=>{const D=T.get(r.msg.message.id);D&&(c.read=D.readCount,c.unread=D.unReadCount)})});const le=T=>{c.unread!==0&&(b.currentReadUnreadList.msgId=T,b.currentReadUnreadList.show=!0)};return(T,D)=>{const oe=De("Avatar"),_e=_o,S=nn,P=si,Y=yt,G=De("Icon"),K=De("RenderMessage"),ke=pt("login");return E(),j(ft,null,[T.isShowTimeBlock&&T.msg.timeBlock?(E(),j("span",Ri,de(T.msg.timeBlock),1)):Q("",!0),X.value?(E(),j("span",Bi,de(u.value.body),1)):Q("",!0),L("div",{ref_key:"msgVisibleEl",ref:ee},[O(kt,{name:"remove"},{default:B(()=>{var we,Me;return[X.value?Q("",!0):(E(),j("div",{key:0,class:ve(s.value)},[O(_e,{placement:"right",trigger:"hover"},{reference:B(()=>[O(oe,{src:x(o).avatar,onContextmenu:D[0]||(D[0]=St(Se=>H(Se),["prevent","stop"]))},null,8,["src"])]),default:B(()=>[O($i,{user:x(o)},null,8,["user"])]),_:1}),L("div",{class:"chat-item-box",ref_key:"boxRef",ref:i},[L("div",Ni,[O(S,{effect:"dark",content:(we=x(e))==null?void 0:we.describe,placement:n.value?"top-end":"top-start",teleported:!1},{default:B(()=>{var Se,Ee;return[be(L("img",{class:"user-badge",src:(Se=x(e))==null?void 0:Se.img},null,8,ji),[[He,(Ee=x(e))==null?void 0:Ee.img]])]}),_:1},8,["content","placement"]),L("span",{class:"user-name",onContextmenu:D[1]||(D[1]=St(Se=>H(Se),["prevent","stop"]))},de(x(o).name),33),L("span",Ai,"("+de(x(o).locPlace||"未知")+")",1),T.isShowTime?(E(),j("span",Pi,de(x(io)(T.msg.message.sendTime)),1)):Q("",!0)]),O(S,{effect:"light","popper-class":"option-tooltip",trigger:T.tooltipTrigger,placement:d.value||"bottom-end",offset:2,"show-arrow":!1,teleported:!1},{content:B(()=>[O(di,{msg:T.msg},null,8,["msg"])]),default:B(()=>{var Se,Ee;return[L("div",{ref_key:"renderMsgRef",ref:t,class:ve(["chat-item-content",{uploading:(Se=T.msg)==null?void 0:Se.loading}]),onContextmenu:D[3]||(D[3]=St(Xe=>J(Xe),["prevent","stop"]))},[n.value?(E(),j("div",{key:0,onClick:D[2]||(D[2]=Xe=>le(T.msg.message.id)),class:ve(["chat-item-read-count",{"is-gray":c.unread===0}])},[c.unread!==0?(E(),j("span",zi,de(c.read),1)):(E(),ie(Y,{key:1},{default:B(()=>[O(P)]),_:1}))],2)):Q("",!0),(Ee=T.msg)!=null&&Ee.loading?(E(),ie(G,{key:1,icon:"loading",size:20,spin:""})):Q("",!0),O(K,{message:u.value},null,8,["message"])],34)]}),_:1},8,["trigger","placement"]),(Me=u.value.body)!=null&&Me.reply?(E(),j("div",{key:0,class:ve(["chat-item-reply",{pointer:u.value.body.reply.canCallback}]),onClick:D[4]||(D[4]=Se=>U(u.value))},[u.value.body.reply.canCallback?(E(),ie(G,{key:0,icon:"totop",size:12})):Q("",!0),L("span",Di,de(u.value.body.reply.username)+": "+de(u.value.body.reply.body),1)],2)):Q("",!0),x(_)+x(M)>0?(E(),j("div",Fi,[O(kt,{name:"fade"},{default:B(()=>[x(_)>0?be((E(),j("span",{key:0,class:ve(["extra-item like",{active:x(k)}])},[O(G,{icon:"like"}),O(kt,{name:"count-up",mode:"out-in"},{default:B(()=>[(E(),j("span",{class:"count",key:x(_)},de(x(_)),1))]),_:1})],2)),[[ke,x($)]]):Q("",!0)]),_:1}),O(kt,{name:"fade"},{default:B(()=>[x(M)>0?be((E(),j("span",{key:0,class:ve(["extra-item dlike",{active:x(I)}])},[O(G,{icon:"dislike",size:17}),O(kt,{name:"count-up",mode:"out-in"},{default:B(()=>[(E(),j("span",{class:"count",key:x(M)},de(x(M)),1))]),_:1})],2)),[[ke,x(z)]]):Q("",!0)]),_:1})])):Q("",!0)],512)],2))]}),_:1})],512),O(gi,{show:v.value,"onUpdate:show":D[5]||(D[5]=we=>v.value=we),options:C.value,msg:T.msg},null,8,["show","options","msg"]),O(yi,{show:y.value,"onUpdate:show":D[6]||(D[6]=we=>y.value=we),options:C.value,uid:T.msg.fromUser.uid},null,8,["show","options","uid"])],64)}}});const Xt=3,Vi=a=>(rn("data-v-34df6e5b"),a=a(),sn(),a),Hi={class:"set-admin"},Wi=Vi(()=>L("span",null,"管理员操作",-1)),Gi={class:"admin-count"},Ki={class:"flex-center"},qi={class:"add-admin-btn flex-center"},Xi=me({__name:"AdvancedSetting",setup(a){const r=Ft(),u=_t(),p=A(!1),g=A([]),h=q(()=>r.memberList.map(n=>({...n,disabled:!!n.roleId}))),b=q(()=>!r.adminUidList.includes(u.userInfo.uid)&&r.currentLordId!==u.userInfo.uid||r.adminList.length>=Xt),o=n=>{n.length+r.adminList.length>Xt&&st.error("管理员数量不能超过"+Xt+"个")},l=async()=>{await r.addAdmin(g.value),p.value=!1,st.success("添加管理员成功")},e=async n=>{await r.revokeAdmin([n]),st.success("撤销管理员成功")};return(n,s)=>{const t=Ot,i=De("Avatar"),d=yt,c=An,f=Ln,v=bo,y=wr,C=co;return E(),j("div",Hi,[L("h5",null,[Wi,L("span",Gi," ("+de(x(r).adminList.length)+"/"+de(x(Xt))+") ",1)]),L("div",Ki,[O(t,{type:"primary",size:"small",onClick:s[0]||(s[0]=k=>p.value=!0),disabled:b.value},{default:B(()=>[Ne(" 设置管理员 ")]),_:1},8,["disabled"]),(E(!0),j(ft,null,Tt(x(r).adminList,k=>(E(),j("div",{key:k.uid,class:"admin-avatar flex-center"},[O(v,{title:"是否撤销该群管理的身份？","confirm-button-text":"确认","cancel-button-text":"取消",width:"200",onConfirm:I=>e(k.uid)},{reference:B(()=>[O(f,{value:"-"},{default:B(()=>[O(c,{src:k.avatar,size:"small"},{default:B(()=>[O(d,{size:10},{default:B(()=>[O(i)]),_:1})]),_:2},1032,["src"])]),_:2},1024)]),_:2},1032,["onConfirm"])]))),128)),O(C,{modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=k=>p.value=k)},{default:B(()=>[O(y,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=k=>g.value=k),data:h.value,props:{key:"uid",label:"name",disabled:"disabled"},class:"add-admin-transfer flex-center",titles:["未设置","已设置"],onLeftCheckChange:o},null,8,["modelValue","data"]),L("div",qi,[O(t,{type:"primary",onClick:l},{default:B(()=>[Ne("添加")]),_:1})])]),_:1},8,["modelValue"])])])}}});const Yi=lt(Xi,[["__scopeId","data-v-34df6e5b"]]),Zi=a=>(rn("data-v-bdfca49f"),a=a(),sn(),a),Ji={class:"dead-zone"},Qi=Zi(()=>L("h5",null,[L("span",null,"退出群聊")],-1)),el={class:"flex-center"},tl=me({__name:"DeadZoneSetting",setup(a){const r=Ft(),u=async()=>{await r.exitGroup(),st.success("退出群聊成功")};return(p,g)=>{const h=Ot,b=bo;return E(),j("div",Ji,[Qi,L("div",el,[O(b,{title:"是否退出该群聊？","confirm-button-text":"确认","cancel-button-text":"取消",width:"200",onConfirm:u},{reference:B(()=>[O(h,{type:"danger",size:"small"},{default:B(()=>[Ne("退出群聊")]),_:1})]),_:1})])])}}});const nl=lt(tl,[["__scopeId","data-v-bdfca49f"]]),ol={class:"setting-box"},rl={class:"advanced"},sl={class:"dead-zone"},al=me({__name:"SettingBox",setup(a){return(r,u)=>{const p=Ur;return E(),j("div",ol,[O(p,{"content-position":"left"},{default:B(()=>[Ne("高级")]),_:1}),L("div",rl,[O(Yi)]),O(p,{"content-position":"left"},{default:B(()=>[Ne("危险区")]),_:1}),L("div",sl,[O(nl)])])}}}),il={class:"room-name"},ll={class:"name"},ul=L("h4",{class:"text-[#f5f5f5]"},"设置",-1),cl=me({__name:"index",setup(a){const r=bt(),u=A(!1);return(p,g)=>{var b,o;const h=rs;return E(),j(ft,null,[L("div",il,[L("span",ll,de((b=x(r).currentSessionInfo)==null?void 0:b.name),1),x(r).isGroup&&!((o=x(r).currentSessionInfo)!=null&&o.hot_Flag)?(E(),j("span",{key:0,class:"setting",onClick:g[0]||(g[0]=l=>u.value=!0)}," 设置 ")):Q("",!0)]),O(h,{modelValue:u.value,"onUpdate:modelValue":g[1]||(g[1]=l=>u.value=l),direction:"rtl","append-to-body":""},{header:B(()=>[ul]),default:B(()=>[O(al)]),_:1},8,["modelValue"])],64)}}});const dl={key:2,class:"empty"},fl=me({__name:"index",setup(a){const r=bt(),u=A(),p=q(()=>r.currentMessageOptions),g=q(()=>r.chatMessageList),h=q(()=>r.currentNewMsgCount),b=()=>{u.value&&(u.value.scrollToBottom(),r.clearNewMsgCount())},o=()=>{var s;u.value.scrollToIndex(g.value.length-(((s=h.value)==null?void 0:s.count)||0)),r.clearNewMsgCount()};Dt("virtualListRef",u),mt(()=>{$t(()=>{r.chatListToBottomAction=()=>{b()}})});const l=async()=>{var t;if((t=p.value)!=null&&t.isLoading)return;const s=u.value.getSizes();await r.loadMore(),u.value.scrollToIndex(u.value.getSizes()-s)},e=So(s=>{const{offset:t,clientSize:i,scrollSize:d}=s;if(!t||!i||!d)return;t+i>=d-i?(h.value&&(h.value.isStart=!1),r.clearNewMsgCount()):h.value&&(h.value.isStart=!0)},100),n=s=>s.message.id;return(s,t)=>{var f,v,y,C,k,I;const i=ya,d=yt,c=pa;return E(),j("div",{class:"chat-msg-list",onContextmenu:t[0]||(t[0]=St(()=>{},["prevent"]))},[O(cl),(f=p.value)!=null&&f.isLoading?(E(),ie(d,{key:0,size:14,class:"loading"},{default:B(()=>[O(i),Ne(" 消息加载中 ")]),_:1})):Q("",!0),(v=g.value)!=null&&v.length?(E(),ie(x(xo),{key:1,ref_key:"virtualListRef",ref:u,class:"virtual-list scroll-hover",dataPropName:"msg",data:g.value,"data-key":n,item:Ui,size:20,onTotop:l,onScroll:x(e),onOk:b},null,8,["data","onScroll"])):Q("",!0),!((y=p.value)!=null&&y.isLoading)&&((C=g.value)==null?void 0:C.length)===0?(E(),j("div",dl,"暂无消息，快来发送第一条消息吧~")):Q("",!0),be(L("span",{class:"new-msgs-tips",onClick:o},[Ne(de((k=h.value)==null?void 0:k.count)+" 条新消息 ",1),O(d,{size:10},{default:B(()=>[O(c)]),_:1})],512),[[He,((I=h.value)==null?void 0:I.count)&&h.value.count>0]])],32)}}});const pl=lt(fl,[["__scopeId","data-v-df8dff3e"]]),ml={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},vl=L("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32H224zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96z"},null,-1),gl=L("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32zm192-160v-64a192 192 0 1 0-384 0v64h384zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64z"},null,-1),hl=[vl,gl];function yl(a,r){return E(),j("svg",ml,hl)}const bl={name:"ep-lock",render:yl},_l={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Cl=L("path",{fill:"currentColor",d:"M764.288 214.592L512 466.88L259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512L214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),kl=[Cl];function Sl(a,r){return E(),j("svg",_l,kl)}const xl={name:"ep-close",render:Sl};var qe=(a=>(a.text="text",a.br="br",a.at="at",a))(qe||{});const wl=a=>{let r="";const u=[];return a.forEach(p=>{if((p.type===qe.text||p.type===qe.br)&&(r+=p.data),p.type===qe.at){const{uid:g=0,name:h="",avatar:b=""}=p.data;u.push({uid:g,name:h,avatar:b,length:h.length+1,offset:r.length}),r+="@"+h}}),{pureString:r,mentionList:u}},Il=(a,r)=>{let u=0;const p=[];if(r.length>0){r.forEach(h=>{const{offset:b,length:o}=h,l=a.slice(u,b);l.length>0&&p.push({type:qe.text,data:l}),p.push({type:qe.at,data:{uid:h.uid,name:h.name,avatar:h.avatar}}),u=b+o});const g=a.slice(u);g.length>0&&p.push({type:qe.text,data:g})}else a.length>0&&p.push({type:qe.text,data:a});return p},In=()=>{let a=null,r=null;return window.getSelection?(r=window.getSelection(),r&&r.getRangeAt&&r.rangeCount?(a=r.getRangeAt(0),{range:a,selection:r}):null):null},Ml=()=>{const a=window,r=a.document;let u=r.selection,p,g,h,b=0,o=0;if(u)u.type!=="Control"&&(p=u.createRange(),p.collapse(!0),b=p.boundingLeft,o=p.boundingTop);else if(a.getSelection&&(u=a.getSelection(),u.rangeCount&&(p=u.getRangeAt(0).cloneRange(),p.getClientRects&&(p.collapse(!0),g=p.getClientRects(),g.length>0&&(h=g[0]),h&&(b=h.left,o=h.top)),b===0&&o===0||h===void 0))){const l=r.createElement("span");if(l.getClientRects){l.appendChild(r.createTextNode("​")),p.insertNode(l),h=l.getClientRects()[0],b=h.left,o=h.top;const e=l.parentNode;e==null||e.removeChild(l),e==null||e.normalize()}}return{x:b,y:o}},On=({content:a,selection:r,range:u})=>{if(!(!r||!u||!a)&&r.getRangeAt(0)&&r.rangeCount){u.deleteContents();const p=document.createElement("div"),g=document.createTextNode(a);p.appendChild(g);const h=document.createDocumentFragment();let b,o;for(;b=p.firstChild;)o=h.appendChild(b);if(u.insertNode(h),o){const l=u.cloneRange();if(!l)return;l.setStartAfter(o),l.collapse(!0),r.removeAllRanges(),r.addRange(l)}}},El={class:"person-item__name"},Ol=me({__name:"item",props:{item:{},activeIndex:{},index:{},onSelect:{type:Function}},setup(a){const r=a,u=()=>{var p;(p=r.onSelect)==null||p.call(r,r.item.uid)};return(p,g)=>{const h=De("Avatar");return E(),j("div",{class:ve(["person-item",{"person-item--active":p.activeIndex===p.index}]),onClick:u},[O(h,{class:"avatar",src:p.item.avatar,size:26},null,8,["src"]),L("div",El,de(p.item.name),1)],2)}}});const Tl=["src"],Ll={class:"dialog-footer"},$l=me({__name:"index",setup(a){const r=A({url:""}),u=A(),p=A(!1),g=_t(),h=Zt("onChangeMsgType"),b=Zt("onChangeFile");jr(window,"paste",e=>{var n;if(e.preventDefault(),!g.isSign)return!1;if(e.clipboardData&&((n=e.clipboardData.files)!=null&&n.length)){const s=e.clipboardData.files[0];s!=null&&s.type.includes("image")&&(u.value=s)}return!1}),yo(()=>{u!=null&&u.value?(p.value=!0,r.value={url:URL.createObjectURL(u==null?void 0:u.value)}):p.value=!1});const o=()=>{r.value.url&&URL.revokeObjectURL(r.value.url),u.value=void 0,r.value={url:""}},l=async()=>{u!=null&&u.value&&(h==null||h(se.IMAGE),await(b==null?void 0:b([u==null?void 0:u.value])),p.value=!1,o())};return(e,n)=>{const s=Ot,t=co;return E(),ie(t,{class:"image-paste-modal",title:"粘贴图片",modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=i=>p.value=i),"close-on-click-modal":!1,center:"",onClose:o},{footer:B(()=>[L("span",Ll,[O(s,{onClick:n[0]||(n[0]=i=>p.value=!1)},{default:B(()=>[Ne("取消")]),_:1}),O(s,{type:"primary",onClick:l},{default:B(()=>[Ne(" 发送 ")]),_:1})])]),default:B(()=>[r.value.url?(E(),j("img",{key:0,src:r.value.url},null,8,Tl)):Q("",!0)]),_:1},8,["modelValue"])}}});const Rl=["text","contenteditable","data-room-id"],Bl=me({inheritAttrs:!1,__name:"index",props:{disabled:{type:Boolean,default:!1},modelValue:{default:""},mentions:{default:()=>[]},maxLength:{default:-1},className:{},style:{}},emits:["update:modelValue","change","focus","blur","callBackRefAndRange","send"],setup(a,{expose:r,emit:u}){const p=a,{modelValue:g,mentions:h,maxLength:b,disabled:o}=mo(p),l=A(),e=A(),n=$n(),s=it(),t=A(!1),i=A([]),d=on({x:0,y:0}),c=A(0),f=A(""),v=A(!1),y=A(null),C=A(""),k=q(()=>s.currentSession.roomId);C.value=g.value;const I=()=>{const S=Il(g==null?void 0:g.value,h.value);l.value&&(S.forEach(P=>{var Y,G;if(P.type===qe.text){const K=document.createTextNode(P.data);(Y=l.value)==null||Y.appendChild(K)}if(P.type===qe.at){const K=document.createElement("button");K.dataset.person=JSON.stringify(P.data),K.textContent=`@${P.data.name}`,K.className="at_member",K.contentEditable="false",K.addEventListener("click",()=>!1,!1),K.tabIndex=0,(G=l.value)==null||G.appendChild(K)}}),v.value=!0)};yo(()=>{var S;if(g.value&&g.value.length>0&&!v.value&&I(),!(g.value&&g.value.length>0)&&!v.value&&setTimeout(()=>{I()},500),!(g.value&&g.value.length>0)&&v&&l.value)for(;(S=l.value)!=null&&S.firstChild;)l.value.removeChild(l.value.firstChild);C.value=g.value}),ot(f,()=>{i.value=n.filterUsers(f.value)}),ot(k,(S,P)=>{S!==P&&(C.value="",i.value=n.currentAtUsersList)},{immediate:!0}),ot(t,()=>{t.value||(c.value=0)}),ot(t,()=>{if(t.value){const{x:S,y:P}=Ml();if(l.value){const Y=l.value.offsetWidth,K=l.value.getBoundingClientRect().left+Y,ke=300;S+ke>K?(d.x=K-ke,d.y=P):(d.x=S,d.y=P)}else d.x=S,d.y=P}}),ot(o,S=>{S||setTimeout(()=>{var P;(P=l.value)==null||P.focus()})}),mt(()=>{$t(()=>{var S;(S=l.value)==null||S.focus()})});const _=()=>{if(l.value){const S=[],P=[].slice.call(l.value.childNodes);P.length>0&&P.forEach(K=>{if(K.nodeName==="#text"){const ke=K;ke.data&&ke.data.length>0&&S.push({type:qe.text,data:ke.data})}if(K.nodeName==="BR"&&S.push({type:qe.br,data:`
`}),K.nodeName==="BUTTON"){const we=JSON.parse(K.dataset.person);S.push({type:qe.at,data:we})}});const{pureString:Y,mentionList:G}=wl(S);Y.length>0&&Y.charAt(Y.length-1)===`
`?u("change",Y.substring(0,Y.length-1),G):u("change",Y,G)}},M=()=>{const S=In();if(!S||!S.range||!S.selection){t.value=!1;return}const P=S.range.endContainer;if(!P||!P.textContent||P.nodeName!=="#text"){t.value=!1;return}const Y=P.textContent.slice(0,S.selection.focusOffset),G=/@([^@]*)$/.exec(Y);if(G&&G.length>=2){const[,K]=G;if(K&&K.length>20){t.value=!1,f.value="",i.value=[];return}t.value=!0,f.value=K,y.value=S}else f.value="",t.value=!1},$=([S,P],Y,G)=>{var K,ke;if(Y.getRangeAt(0)&&Y.rangeCount){if(((ke=(K=Y.focusNode)==null?void 0:K.parentNode)==null?void 0:ke.nodeName)==="BUTTON")return;G.deleteContents();const we=document.createElement("div");we.appendChild(S),P&&we.appendChild(P);const Me=document.createDocumentFragment();let Se,Ee;for(;Se=we.firstChild;)Ee=Me.appendChild(Se);G.insertNode(Me),Ee&&(G=G.cloneRange(),G.setStartAfter(Ee),G.collapse(!0),Y.removeAllRanges(),Y.addRange(G))}},z=(S,P=!1)=>{var G,K,ke,we;t.value=!1,(G=e.value)==null||G.scrollToIndex(0);const Y=l.value;if(Y){Y.focus();const Me=(K=y==null?void 0:y.value)==null?void 0:K.range;if(!Me)return;const Se=Me.endContainer,Ee=Me.endOffset,Xe=Se.nodeValue,Ie=/@([^@]*)$/.exec(Xe);if(Ie&&Ie.length>1||P){!P&&(Ie!=null&&Ie.length)&&(Me.setStart(Se,Ie.index),Me.setEnd(Se,Ee),Me.deleteContents());const Qe=document.createElement("button");Qe.dataset.person=JSON.stringify(S),Qe.textContent=`@${S.name}`,Qe.className="at_member",Qe.contentEditable="false",Qe.addEventListener("click",()=>!1,!1),Qe.tabIndex=0;const Rt=document.createTextNode(" ");$([Qe,Rt],(ke=y==null?void 0:y.value)==null?void 0:ke.selection,(we=y==null?void 0:y.value)==null?void 0:we.range)}_()}},X=S=>{S.key==="2"&&S.shiftKey?t.value=!0:M()},U=S=>{if(!e.value)return;let P=0;if(S==="up"){if(P=c.value-1,P<0)return;P<e.value.getOffset()/34&&e.value.scrollToIndex(P)}if(S==="down"){if(P=c.value+1,P>i.value.length+1)return;P>6&&e.value.scrollToIndex(P-6)}c.value=P},J=S=>{if(b.value&&b.value>0&&S.target.innerText.length>=b.value&&(S.key==="Backspace"||S.key==="Delete"||S.preventDefault()),t.value&&i.value.length>0)S.key==="ArrowDown"&&(S.preventDefault(),U("down")),S.key==="ArrowUp"&&(S.preventDefault(),U("up")),S.key==="Enter"&&(S.preventDefault(),z(i.value[c.value]),H());else{if(S.ctrlKey&&S.key==="Enter"||S.shiftKey&&S.key==="Enter"||S.metaKey&&S.key==="Enter"){S.preventDefault(),le();return}if(S.isComposing)return S.preventDefault();S.key==="Enter"&&(S.preventDefault(),u("send",S))}if(S.ctrlKey||S.metaKey)switch(S.key){case"B":case"2":case"I":case"9":case"U":case"F6":{S.preventDefault();break}}S.key==="Tab"&&(S.preventDefault(),document.execCommand("insertHTML",!1,"  "))},H=()=>{if(l.value){const S=l.value.innerText;C.value=S,u("update:modelValue",S)}_()},ee=()=>{u("blur"),y.value=In(),u("callBackRefAndRange",l.value,y.value),setTimeout(()=>{var S;t.value=!1,(S=e.value)==null||S.scrollToIndex(0),setTimeout(()=>{f.value=""},0)},300)},le=()=>{const S=In();!S||!S.range||!S.selection||On({content:`
`,selection:S.selection,range:S.range})},T=()=>{u("focus"),M()},D=S=>{S.preventDefault();let P;return window.clipboardData&&window.clipboardData.getData?P=window.clipboardData.getData("Text"):S.clipboardData&&S.clipboardData.getData&&(P=S.clipboardData.getData("text/plain")),document.execCommand("insertHTML",!1,P),!1},oe=(S,P=!1)=>{S&&(rt.emit("focusMsgInput"),setTimeout(()=>{const Y=n.userCachedList[S];Y&&(z==null||z(Y,P))},10))};r({input:l,range:y,onSelectPerson:oe});const _e=S=>S.uid;return(S,P)=>{var Y,G;return E(),j("div",{class:ve(["input-wrapper",[S.className,S.$attrs.class]]),style:zt([S.style,S.$attrs.style])},[L("div",Ut({ref_key:"editorRef",ref:l},S.$attrs,{class:"input",id:"at-mentions-input",text:S.modelValue,contenteditable:!x(o),onInput:H,onKeyup:X,onKeydown:J,onBlur:ee,onFocus:T,onMouseup:M,onPaste:D,"data-room-id":(Y=x(s).currentSession)==null?void 0:Y.roomId}),null,16,Rl),be(L("div",{className:"at-mentions__dialog",style:zt({top:`${d.y-14}px`,left:`${d.x||0}px`})},[(G=i.value)!=null&&G.length?(E(),ie(x(xo),{key:0,ref_key:"scrollRef",ref:e,class:"person-wrapper",dataPropName:"item",itemProps:{activeIndex:c.value,onSelect:oe},data:i.value,"data-key":_e,item:Ol,size:20},null,8,["itemProps","data"])):Q("",!0)],4),[[He,t.value]]),O($l)],6)}}});const Nl=lt(Bl,[["__scopeId","data-v-f5e6656b"]]),jl=["😀","😃","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","😘","😗","😙","😚","😋","😛","😝","😜","🤪","🤨","🧐","🤓","😎","🤩","😏","😒","😞","😔","😟","😕","🙁","😣","😖","😫","😩","😢","😭","😮","💨","😤","😠","😡","🤬","🤯","😳","😱","😨","😰","😥","😓","🤗","🤔","🤭","🤫","🤥","😶","🌫️","😐","😑","😬","🙄","😯","😦","😧","😮","😲","😴","🤤","😪","😵","💫","🤐","🤢","🤮","🤧","😷","🤒","🤕","🤑","🤠","😈","👿","👹","👺","🤡","💩","👻","💀","👽","👾","🤖","🎃","😺","😸","😹","😻","😼","😽","🙀","😿","😾","🐶"],Mo=100,Al=Mo*1024*1024,Pl=()=>{const a=A(!1),r=A(0),u=A(null),{on:p,trigger:g}=Mt(),h=Mt(),b=async(t,i,d)=>{a.value=!0;const c=new XMLHttpRequest;c.open("PUT",t,!0),c.setRequestHeader("Content-Type",i.type),c.upload.onprogress=function(f){d||(r.value=Math.round(f.loaded/f.total*100))},c.onload=function(){a.value=!1,!d&&(c.status===200?g("success"):g("fail"))},c.send(i)},o=t=>new Promise((i,d)=>{const c=document.createElement("video"),f=URL.createObjectURL(t);c.src=f,c.crossOrigin="anonymous",c.currentTime=2,c.oncanplay=()=>{var y;const v=document.createElement("canvas");v.width=c.videoWidth,v.height=c.videoHeight,(y=v.getContext("2d"))==null||y.drawImage(c,0,0,v.width,v.height),v.toBlob(C=>{if(!C)return;const k=Date.now()+"thumb.jpg",I=new File([C],k,{type:"image/jpeg"});at.getUploadUrl({fileName:k,scene:"1"}).send().then(_=>{if(_.uploadUrl&&_.downloadUrl){b(_.uploadUrl,I,!0);const M=setInterval(()=>{a.value||(clearInterval(M),i({thumbWidth:v.width,thumbHeight:v.height,thumbUrl:_.downloadUrl,thumbSize:I.size,tempUrl:f}))})}})})},c.onerror=function(){URL.revokeObjectURL(f),d({width:0,height:0,url:null})}}),l=t=>{const i=new Image,d=URL.createObjectURL(t);return i.src=d,new Promise((c,f)=>{i.onload=function(){c({width:i.width,height:i.height,tempUrl:d})},i.onerror=function(){URL.revokeObjectURL(d),f({width:0,height:0,url:null})}})},e=t=>new Promise((i,d)=>{const c=new Audio,f=URL.createObjectURL(t);c.src=f,(async()=>{for(;isNaN(c.duration)||c.duration===1/0;)await new Promise(C=>setTimeout(C,100)),c.currentTime=1e5*Math.random();const y=Math.round(c.duration||0);i({second:y,tempUrl:f})})(),c.onerror=function(){d({second:0,tempUrl:f})}}),n=async(t,i={})=>{var C;const{name:d,size:c,type:f}=t,v=((C=d.split(".").pop())==null?void 0:C.trim().toLowerCase())||"",y={name:d,size:c,type:f,suffix:v,...i};if(f.includes("image")){const{width:k,height:I,tempUrl:_}=await l(t);return{...y,width:k,height:I,tempUrl:_}}if(f.includes("audio")){const{second:k,tempUrl:I}=await e(t);return{second:k,tempUrl:I,...y}}if(f.includes("video")){const{thumbWidth:k,thumbHeight:I,tempUrl:_,thumbTempUrl:M,thumbUrl:$,thumbSize:z}=await o(t);return{...y,thumbWidth:k,thumbHeight:I,tempUrl:_,thumbTempUrl:M,thumbUrl:$,thumbSize:z}}return y},s=async(t,i)=>{if(a.value||!t)return;const d=await n(t,i);if(d.size>Al){st.warning(`文件不得大于 ${Mo} MB`);return}const{downloadUrl:c,uploadUrl:f}=await at.getUploadUrl({fileName:d.name,scene:"1"}).send();f&&c?(u.value={...d,downloadUrl:c},h.trigger(u),b(f,t)):g("fail")};return{fileInfo:u,isUploading:a,progress:r,onStart:h.on,onChange:p,uploadFile:s}},zl=()=>{const a=A(!1),r=A(null),u=A(0),p=A(null),g=Mt(),{isSupported:h,stream:b,start:o,stop:l}=Ar({constraints:{audio:!0}}),e=()=>{a.value=!1,u.value=0,p.value=null,r.value&&clearInterval(r.value)},n=async()=>{if(!h.value){st.warning("当前环境不支持录音");return}if(e(),await o(),!b.value)return;p.value=new MediaRecorder(b.value),p.value.start(),a.value=!0,r.value=setInterval(()=>{u.value++,u.value>=59&&s()},1e3);const t=[];p.value.addEventListener("dataavailable",i=>{t.push(i.data)}),p.value.addEventListener("stop",()=>{r.value&&clearInterval(r.value);const i=new Blob(t,{type:"audio/wav"}),d=new File([i],`${Date.now()}.wav`,{type:"audio/wav"});if(u.value<2){st.warning("录制时间太短");return}g.trigger(d),e()})},s=()=>{p.value&&(p.value.stop(),l())};return{isRecording:a,second:u,start:n,stop:s,reset:e,onEnd:g.on}},Dl=()=>{const a=it(),r=q(()=>JSON.parse(localStorage.getItem("USER_INFO")||"{}")),u=q(()=>a.currentSession.roomId);return{mockMessage:(g,h,b)=>{const o=Date.now(),l=Math.floor(Math.random()*15),e=Number(String(o).slice(-7)+l),n=g===1?h.content:null,{uid:s,name:t,avatar:i}=r.value;return{fromUser:{username:t,uid:s,avatar:i,locPlace:"XX"},message:{id:e,roomId:u.value,sendTime:Number(o),content:n,urlContentMap:{},type:g,body:h,messageMark:{likeCount:0,userLike:0,dislikeCount:0,userDislike:0,...b}},sendTime:String(o),loading:!0}}}},Eo=a=>(rn("data-v-ccfa02b0"),a=a(),sn(),a),Fl={class:"chat-edit"},Ul={class:"reply-msg-wrapper"},Vl={class:"msg-input"},Hl={class:"recorded-tips"},Wl={class:"emoji-panel"},Gl={class:"emoji-panel-content"},Kl={class:"emoji-list"},ql={class:"emoji-panel-content"},Xl=["onClick","onContextmenu"],Yl=["src"],Zl={key:1,class:"item-add"},Jl={class:"footer"},Ql=Eo(()=>L("div",{class:"divider"},null,-1)),eu=Eo(()=>L("span",{class:"tips-text"},"登录",-1)),tu={key:1,class:"tips"},nu=me({__name:"index",setup(a){const r=Ir(),u=bt(),p=it(),g=A(!1),h=A(""),b=A(),o=A([]),l=A(!1),e=A(!1),n=A(0),s=A(!1),t=A(se.FILE),i=A(0),d=A(!1),c=A(-1),f=()=>{setTimeout(()=>{var N,ue,Le,xe;if(!b.value)return;(ue=(N=b.value)==null?void 0:N.focus)==null||ue.call(N);const Z=(xe=(Le=b.value)==null?void 0:Le.range)==null?void 0:xe.selection;Z==null||Z.selectAllChildren(b.value.input),Z==null||Z.collapseToEnd()})},v=({uid:Z,ignoreCheck:N})=>{var ue,Le;(Le=(ue=b.value)==null?void 0:ue.onSelectPerson)==null||Le.call(ue,Z,N),l.value=!1};mt(()=>{rt.on("onSelectPerson",v),rt.on("focusMsgInput",f)}),po(()=>{rt.off("onSelectPerson",v),rt.off("focusMsgInput",f)});const y=(Z,N)=>{at.sendMsg({roomId:p.currentSession.roomId,msgType:Z,body:N}).send().then(ue=>{ue.message.type===se.TEXT?u.pushMsg(ue):u.updateMsg(n.value,ue),h.value="",le(),u.updateSessionLastActiveTime(p.currentSession.roomId)}).finally(()=>{var ue;g.value=!1,f(),(ue=u.chatListToBottomAction)==null||ue.call(u)})},C=()=>{var Z,N;!((Z=h.value)!=null&&Z.trim().length)||g.value||(g.value=!0,y(se.TEXT,{content:h.value,replyMsgId:(N=z.value.message)==null?void 0:N.id,atUidList:o.value.map(ue=>ue.uid)}))},k=hr(),I=_t(),_=Bn(),M=Ft(),$=q(()=>I.isSign),z=q(()=>I.isSign&&u.currentMsgReply||{}),X=q(()=>{var Z;return(Z=z==null?void 0:z.value.fromUser)==null?void 0:Z.uid}),U=tn(X),J=q(()=>_.emojiList),H=q(()=>M.countInfo.role===Et.REMOVED),ee=()=>{var ue,Le,xe;const Z=U==null?void 0:U.value.name,N=(ue=z==null?void 0:z.value.message)==null?void 0:ue.type;return Co(Z,N,(xe=(Le=z==null?void 0:z.value.message)==null?void 0:Le.body)==null?void 0:xe.content)},le=()=>u.currentMsgReply={},T=Z=>{var Le,xe;const N=(Le=b.value)==null?void 0:Le.input,ue=(xe=b.value)==null?void 0:xe.range;!N||!ue||(On({content:Z,...ue}),h.value=N.innerText,s.value=!1,f())},D=(Z,N)=>{o.value=N},oe=on({multiple:!1,accept:".jpg,.png"}),{open:_e,reset:S,onChange:P}=Pr(oe),{isUploading:Y,fileInfo:G,uploadFile:K,onStart:ke,onChange:we}=Pl(),{uploadEmoji:Me,isEmojiUp:Se}=Io(),{isRecording:Ee,start:Xe,stop:Ie,onEnd:Qe,second:Rt}=zl(),{mockMessage:Vt}=Dl(),Bt=(Z,N=!1)=>{Z==="img"&&(t.value=se.IMAGE,oe.accept=".jpg,.png,.gif,.jpeg,.webp"),Z==="file"&&(t.value=se.FILE,oe.accept="*"),d.value=N,_e()},Ht=async Z=>{if(!(Z!=null&&Z.length))return;const N=Z[0];if(t.value===se.IMAGE&&!N.type.includes("image"))return st.error("请选择图片文件");d.value?await Me(N):await K(N)};Dt("onChangeFile",Ht),Dt("onChangeMsgType",Z=>{t.value=Z}),P(Ht),ke(()=>{var Le;if(!G.value)return;G.value.type.includes("video")&&(t.value=se.VIDEO);const{type:Z,body:N}=ro(G.value,t.value,!0),ue=Vt(Z,N);n.value=ue.message.id,u.pushMsg(ue),(Le=u.chatListToBottomAction)==null||Le.call(u)}),we(Z=>{if(Z==="success"){if(!G.value)return;const{body:N,type:ue}=ro(G.value,t.value);y(ue,N)}S()}),Qe(Z=>K(Z));const Ct=()=>{t.value=se.VOICE,Xe()},an=(Z,N)=>{Z.preventDefault(),c.value=c.value===N?-1:N},ln=So(Z=>{y(se.EMOJI,{url:Z}),s.value=!1},1e3);return(Z,N)=>{const ue=xl,Le=yt,xe=De("Icon"),Nt=_o,un=bl,cn=pt("login");return E(),j("div",Fl,[be(L("div",Ul,[L("span",null,de(ee()),1),O(Le,{class:"reply-msg-icon",size:14,onClick:le},{default:B(()=>[O(ue)]),_:1})],512),[[He,Object.keys(z.value).length]]),L("div",Vl,[L("div",{class:"action",onClick:N[0]||(N[0]=ge=>l.value=!l.value)},[be(O(xe,{icon:"voice",class:"audio"},null,512),[[He,!l.value]]),be(O(xe,{icon:"jianpan"},null,512),[[He,l.value]])]),be(L("div",{class:"recorded",onMousedown:N[1]||(N[1]=ge=>Ct()),onMouseup:N[2]||(N[2]=ge=>x(Ie)()),onTouchstartPassive:N[3]||(N[3]=ge=>Ct()),onTouchendPassive:N[4]||(N[4]=ge=>x(Ie)())},[L("div",Hl,de(x(Ee)?`录制中 ${x(Rt)}s`:"按住说话"),1)],544),[[He,l.value]]),be(O(Nl,{class:"m-input",modelValue:h.value,"onUpdate:modelValue":N[5]||(N[5]=ge=>h.value=ge),ref_key:"mentionRef",ref:b,autofocus:"",tabindex:!$.value||g.value,disabled:!$.value||g.value,placeholder:$.value?g.value?"消息发送中":"来聊点什么吧~":"",mentions:o.value,onChange:D,onSend:C},null,8,["modelValue","tabindex","disabled","placeholder","mentions"]),[[He,!l.value]]),O(Nt,{placement:"top",effect:"dark",title:"",visible:s.value,"onUpdate:visible":N[11]||(N[11]=ge=>s.value=ge),"popper-class":"emoji-warpper","show-arrow":!1,width:x(r)==="PC"?385:"95%",trigger:"click"},{reference:B(()=>[L("div",{class:"action",onMouseover:N[6]||(N[6]=ge=>e.value=!0),onMouseleave:N[7]||(N[7]=ge=>e.value=!1)},[e.value?(E(),ie(xe,{key:0,icon:"shocked",size:18,colorful:""})):(E(),ie(xe,{key:1,icon:"happy1",size:18,colorful:""}))],32)]),default:B(()=>[L("div",Wl,[be(L("div",Gl,[L("ul",Kl,[(E(!0),j(ft,null,Tt(x(jl),(ge,ut)=>be((E(),j("li",{class:"emoji-item",key:ut},[Ne(de(ge),1)])),[[cn,()=>T(ge)]])),128))])],512),[[He,i.value===0]]),be(L("div",ql,[(E(!0),j(ft,null,Tt(J.value,ge=>(E(),j("div",{key:ge.id,class:"item",onClick:ut=>x(ln)(ge.expressionUrl),onContextmenu:ut=>an(ut,ge.id)},[L("img",{src:ge.expressionUrl},null,8,Yl),ge.id===c.value?(E(),ie(xe,{key:0,icon:"guanbi1",class:"del",onClick:St(ut=>x(_).deleteEmoji(ge.id),["stop"])},null,8,["onClick"])):Q("",!0)],40,Xl))),128)),J.value.length<50&&!x(Se)?(E(),ie(xe,{key:0,class:"cursor-pointer item-add",icon:"tianjia",size:30,onClick:N[8]||(N[8]=ge=>Bt("img",!0))})):(E(),j("div",Zl,[O(xe,{icon:"loading",spin:"",size:30})]))],512),[[He,i.value===1]]),L("div",Jl,[O(xe,{class:ve(["cursor-pointer","footer-act",{active:i.value===0}]),icon:"biaoqing",size:18,onClick:N[9]||(N[9]=ge=>i.value=0)},null,8,["class"]),O(xe,{class:ve(["cursor-pointer","footer-act",{active:i.value===1}]),icon:"aixin",size:18,onClick:N[10]||(N[10]=ge=>i.value=1)},null,8,["class"])])])]),_:1},8,["visible","width"]),O(xe,{class:"action",icon:"at",size:20,colorful:"",onClick:N[12]||(N[12]=ge=>{var ut;return x(On)({content:"@",...(ut=b.value)==null?void 0:ut.range})})}),O(xe,{class:ve(["action",{disabled:x(Y)}]),icon:"tupian",size:18,colorful:"",onClick:N[13]||(N[13]=ge=>Bt("img"))},null,8,["class"]),O(xe,{class:"action",icon:"wenjianjia2",size:20,colorful:"",onClick:N[14]||(N[14]=ge=>Bt("file"))}),Ql,L("div",{class:ve(["action",{"is-edit":h.value.length,disabled:!h.value.length}]),onClick:C},[O(xe,{class:"send",icon:"huojian",size:20})],2)]),$.value?Q("",!0):(E(),j("span",{key:0,class:"tips",onClick:N[15]||(N[15]=ge=>x(k).showLogin=!0)},[O(Le,{class:"icon-lock"},{default:B(()=>[O(un)]),_:1}),Ne(" 点我"),eu,Ne("之后再发言~ ")])),$.value&&H.value?(E(),j("span",tu," 您已被踢出群聊，无法再发送消息 ")):Q("",!0)])}}});const ou=lt(nu,[["__scopeId","data-v-ccfa02b0"]]),ru={class:"chat-box"},su={class:"chat-wrapper"},au={key:1,class:"chat"},iu=me({__name:"index",setup(a){const r=A(!1),u=it(),p=q(()=>u.currentSession);return(g,h)=>{const b=Xs,o=yt;return E(),j("div",ru,[L("div",su,[r.value?(E(),ie(o,{key:0,size:160,color:"var(--font-light)"},{default:B(()=>[O(b)]),_:1})):(E(),j("div",au,[O(pl),O(ou)]))]),be(O(la,null,null,512),[[He,p.value.type===x(uo).Group]])])}}});const lu=lt(iu,[["__scopeId","data-v-18afe9df"]]),gu=me({__name:"index",setup(a){const r=it();return r.unReadMark.newMsgUnreadCount=0,(u,p)=>(E(),j(ft,null,[O(Vs),O(lu)],64))}});export{gu as default};
